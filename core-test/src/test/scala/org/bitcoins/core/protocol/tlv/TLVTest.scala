package org.bitcoins.core.protocol.tlv

import org.bitcoins.core.protocol.dlc.models.ContractInfo
import org.bitcoins.testkitcore.gen.TLVGen
import org.bitcoins.testkitcore.util.BitcoinSUnitTest

class TLVTest extends BitcoinSUnitTest {

  "NormalizedString" must "correctly compare" in {
    val original =
      "G�\u0006=ẁ7\u007F8�\u0001 �\u0001z �/�\u001F��\u0001\u0001��\u0001�d\u0012\u0001� �\u007F���\u0001�\u0001��9�\u0001\u007F��\u007F\u0001'��\u0001�\u001B���\u001F"
    val normalized =
      "G�\u0006=ẁ7\u007F8�\u0001 �\u0001z �/�\u001F��\u0001\u0001��\u0001�d\u0012\u0001� �\u007F���\u0001�\u0001��9�\u0001\u007F��\u007F\u0001'��\u0001�\u001B���\u001F"

    assert(NormalizedString(original) == NormalizedString(normalized))
  }

  "TLV" must "have serialization symmetry" in {
    forAll(TLVGen.tlv) { tlv =>
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  it must "have unique types" in {
    val allTypes = TLV.allFactories.map(_.tpe)
    assert(allTypes.distinct == allTypes)
  }

  "UnknownTLV" must "have serialization symmetry" in {
    forAll(TLVGen.unknownTLV) { unknown =>
      assert(UnknownTLV(unknown.bytes) == unknown)
      assert(TLV(unknown.bytes) == unknown)
    }
  }

  "InitTLV" must "have serialization symmetry" in {
    forAll(TLVGen.initTLV) { init =>
      assert(InitTLV(init.bytes) == init)
      assert(TLV(init.bytes) == init)
    }
  }

  "ErrorTLV" must "have serialization symmetry" in {
    forAll(TLVGen.errorTLV) { error =>
      assert(ErrorTLV(error.bytes) == error)
      assert(TLV(error.bytes) == error)
    }
  }

  "AmtToForwardTLV" must "have serialization symmetry" in {
    forAll(TLVGen.amtToForwardTLV) { tlv =>
      assert(AmtToForwardTLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "OutgoingCLTVValueTLV" must "have serialization symmetry" in {
    forAll(TLVGen.outgoingCLTVValueTLV) { tlv =>
      assert(OutgoingCLTVValueTLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "ShortChannelIdTLV" must "have serialization symmetry" in {
    forAll(TLVGen.shortChannelIdTLV) { tlv =>
      assert(ShortChannelIdTLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "PaymentDataTLV" must "have serialization symmetry" in {
    forAll(TLVGen.paymentDataTLV) { tlv =>
      assert(PaymentDataTLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "PingTLV" must "have serialization symmetry" in {
    forAll(TLVGen.pingTLV) { ping =>
      assert(PingTLV(ping.bytes) == ping)
      assert(TLV(ping.bytes) == ping)
    }
  }

  "PongTLV" must "have serialization symmetry" in {
    forAll(TLVGen.pongTLV) { pong =>
      assert(PongTLV(pong.bytes) == pong)
      assert(TLV(pong.bytes) == pong)
    }
  }

  "EventDescriptorTLV" must "have serialization symmetry" in {
    forAll(TLVGen.eventDescriptorTLV) { tlv =>
      assert(EventDescriptorTLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "EnumEventDescriptorTLV" must "have serialization symmetry" in {
    forAll(TLVGen.enumEventDescriptorV0TLV) { tlv =>
      assert(EnumEventDescriptorV0TLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "DigitDecompositionEventDescriptorV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.digitDecompositionEventDescriptorV0TLV) { tlv =>
      assert(DigitDecompositionEventDescriptorV0TLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "OracleEventV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.oracleEventV0TLV) { tlv =>
      val oracleEvent = OracleEventV0TLV(tlv.bytes)
      assert(oracleEvent == tlv)
      assert(oracleEvent.maturation == tlv.maturation)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "OracleAnnouncementV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.oracleAnnouncementV0TLV) { tlv =>
      assert(OracleAnnouncementV0TLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  "OracleAttestmentV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.oracleAttestmentV0TLV) { tlv =>
      assert(OracleAttestmentV0TLV(tlv.bytes) == tlv)
      assert(TLV(tlv.bytes) == tlv)
    }
  }

  it must "have contract info serialization symmetry" in {
    forAll(TLVGen.contractInfoV0TLV) { contractInfo =>
      assert(ContractInfoV0TLV(contractInfo.bytes) == contractInfo)
    //assert(TLV(contractInfo.bytes) == contractInfo)
    }
  }

  "ContractDescriptorV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.contractDescriptorV0TLV) { contractDescriptorV0TLV =>
      assert(
        ContractDescriptorV0TLV(
          contractDescriptorV0TLV.bytes) == contractDescriptorV0TLV)
    //assert(TLV(contractDescriptorV0TLV.bytes) == contractDescriptorV0TLV)
    }
  }

  it must "have contract descriptor v1 serialization symmetry" in {
    forAll(TLVGen.contractDescriptorV1TLV) { contractDescriptorV1TLV =>
      val deserialized = ContractDescriptorV1TLV(contractDescriptorV1TLV.bytes)
      assert(deserialized == contractDescriptorV1TLV)
    //assert(TLV(contractDescriptorV1TLV.bytes) == contractDescriptorV1TLV)
    }
  }

  "OracleInfoV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.oracleInfoV0TLV) { oracleInfo =>
      assert(OracleInfoV0TLV(oracleInfo.bytes) == oracleInfo)
    //assert(TLV(oracleInfo.bytes) == oracleInfo)
    }
  }

  "OracleInfoV1TLV" must "have serialization symmetry" in {
    forAll(TLVGen.oracleInfoV1TLV) { oracleInfo =>
      assert(OracleInfoV1TLV(oracleInfo.bytes) == oracleInfo)
    //assert(TLV(oracleInfo.bytes) == oracleInfo)
    }
  }

  it must "have funding input serialization symmetry" in {
    forAll(TLVGen.fundingInputV0TLV()) { fundingInput =>
      assert(FundingInputV0TLV(fundingInput.bytes) == fundingInput)
//      assert(TLV(fundingInput.bytes) == fundingInput)
    }
  }

  "CETSignaturesV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.cetSignaturesV0TLV) { cetSigs =>
      assert(CETSignaturesV0TLV(cetSigs.bytes) == cetSigs)
//      assert(TLV(cetSigs.bytes) == cetSigs)
    }
  }

  "FundingSignaturesV0TLV" must "have serialization symmetry" in {
    forAll(TLVGen.fundingSignaturesV0TLV) { fundingSigs =>
      assert(FundingSignaturesV0TLV(fundingSigs.bytes) == fundingSigs)
//      assert(TLV(fundingSigs.bytes) == fundingSigs)
    }
  }

  it must "have dlc offer tlv serialization symmetry" in {
    forAll(TLVGen.dlcOfferTLV) { offer =>
      assert(DLCOfferTLV(offer.bytes) == offer)
      assert(TLV(offer.bytes) == offer)
    }
  }

  "DLCAcceptTLV" must "have serialization symmetry" in {
    forAll(TLVGen.dlcAcceptTLV) { accept =>
      assert(DLCAcceptTLV(accept.bytes) == accept)
      assert(TLV(accept.bytes) == accept)
    }
  }

  "DLCSignTLV" must "have serialization symmetry" in {
    forAll(TLVGen.dlcSignTLV) { sign =>
      assert(DLCSignTLV(sign.bytes) == sign)
      assert(TLV(sign.bytes) == sign)
    }
  }

  it must "parse a contract info pre 144" in {
    //this was a contract info created before we implemented support for
    //https://github.com/discreetlogcontracts/dlcspecs/pull/144
    val oldHex =
      "fdd82efd032500000000000186a0fda720540011fda72648000501000000000000000000000001fd9c400000000000000000000001fda604000000000000c350000001fdafc800000000000186a0000001fe0001ffff00000000000186a00000fda724020000fda712fd02bffdd824fd02b9659e890eef1b223ba45c9993f88c7997859302fd5510ac23f4cac0d4ee8232a77ecbdf50c07f093794370e6a506a836f6b0fb54b45f1fb662e1307166d2e57030574f77305826939fa9124d19bfa8a8b2f00f000586b8c58c79ee8b77969a949fdd822fd025300114762c188048a953803f0edeeeb68c69e6cdc1d371ba8d517003accfe05afc4d6588c3ea326512bc66c26a841adffa68330b8c723da442792e731fb19fda94274a7766bb48e520f118c100bbe62dc3806a8d05a63d92e23683a04b0b8c24148cd166585a6b33b995b3d6c083523a8435b156c05100d88f449f4754310d5574d5e88aad09af1b8ba942cfd305e728044ec6360d847254453ec05b1b518a36660e2238360e02f3a004663a7f3a3534973d8b66a2646c1386779aa820672b6361b88a8696395c0add87840b460dfd8a8c0d520017efc6bf58267d4c9d2a225c5d0e5719068a7dda5d630d7432239b6c9d921d5f3842b584503460ca52612ac2e64337d299513690372e8f4770eb8a28080e8d7c29920ca32af470d65d6f916ee81e3ac15ce02684ba6d2522a9ffea1de7e202b4b699ef7ec4f089dda07f3de5b7d1f853b2c56471999be4efca82674a651c80f047ba3a2b9e6f9999f0cd4062c533d1ae29cab2a5e33cbe98728b7b4271c67f7c5cd6e12e39128b9971e08496cbd84cfa99c77c88867d33e73acef37022ba4422a5221776991d45416db71fb54bc6c104f6a8e50e8905161709215104a7e7b97e866f32cf43233ffd615cab66699832ec607cf59c85a7f56fa957aa5f5d7ec9f46d84d5d4b777122d41ad76c6f4968aeedca243f2030d4f502e58f4181130e9afb75309ac21637bcfd0717528bfb82ffe1b6c9fadee6ba70357210990539184bcc913a0ec65837a736733a2fb6172d601b3900fdd80a11000200074254432f55534400000000001117626974636f696e2d732d70726963652d6578616d706c65"
    //https://test.oracle.suredbits.com/contract/numeric/d4d4df2892fb2cfd2e8f030f0e69a568e19668b5d355e7713f69853db09a4c33
    assert(ContractInfo.fromHexOpt(oldHex).isDefined)
  }

  it must "read offer tlv with a enum contract before the gamma version of the DLC spec" in {
    val hex =
      "a71a006fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000fdd82efd01350000000000002710fda71034020e4d756d62616920496e6469616e730000000000002710134368656e6e6169205375706572204b696e67730000000000000000fda712f1fdd824ede6d72c49ff80d52477a6e63bb91b220ca73d518dc3916cc7d6965f96cb99287c5fdf857af173280056dabbb503d79fd5d9acc223d56ba266709d6d7bc2a68fd2e7cb16630cbfea204636518d87e332426d59fb775ac27bacfee89dcf7ab5d015fdd8228900019ac570595231e581af48f2d9c4265b3348f8d146772eeeee9fbe3cf630032a7f6261a2a8fdd8062500020e4d756d62616920496e6469616e73134368656e6e6169205375706572204b696e6773394d756d62616920496e6469616e73207673204368656e6e6169205375706572204b696e67732c2033337264204d617463682049504c3230323202d32f1a5c3711d06589ae3645e52e1ac3a0b0e27f63cb01866e775bdf1b0ce5c000160014c9a41dbf8b5f9278d4f036999522ffe316597dbcef46cca55d3ac31900000000000013880002fda714fd024790c94962869672310231020000000001038f44d1edc23e24929aa90a27ea5a648298be9459f75c7721260f8bf3239958173800000000fdffffff2bb12cc82f4f6e713549b88e44c1b5f477ee72d41d86302fc6ca79adb28042a20000000000fdffffffe8bb1604b519d65b4244b2a1632de0439fde0431ce466be98fc4bef84e840b910000000000fdffffff033d260000000000001600148e23085517399401b2b08d2fdcb78d078fd7bdb0220c0000000000001600143654564e0193ff582cdd3e09afab3ee3ba922ec64a87010000000000220020081bb2767238a501c862c3fbb5345b2088f87938444af1ff88931f7d2bd9b69602473044022073de0571dc7bbb73a484637f57fedcc28275f61e6203a834ac131c9f9c3a557a022018b80d94808e176fb115e13351d6f5980fa7f2c1faa43dc1b7435c1d3d44f7b9012103ba8400cfc8bcc2e9617de10fa4d5b083a744294aada3d0c53561ced29e066fdd0247304402207c7e1d887ea57161a6c75ec0114f4bbcf40149a15c4babdae4d81ba71144b008022033d6d5b95fdf2c4b4dd838a59255c77e3796402f1dd31a63ffb92fca266b9c090121032a5bd5f0e0dda450b0105509c8a9ef19e417c86acc8a09cef00946c1fc7bda0a02473044022004c83d2d452c4855c545b8a56b987189e13063588d5131af41e5eb23c366e3a602204eca9b46e77d7041ea71f9871db8a0e3341b14f015798501fb9814eb116030c2012102ccaf476ee9834da41b9e6d119c039d13348dc7f588d9bfa5c674d1098543c3420000000000000001fffffffd006b0000fda714fd014447ac0d51c6e87905012e02000000000101440a17fef4c9c5617d2e40afed7f2ddc730cbad765adece73a9d48454825ae960000000000feffffff0110270000000000001600144631709e51d3725f7f2fc1a686492fc8830ecf1f040047304402205d0cf87497292d39e3ae7d88448cb2b98648466f0bb0adeb32837e6aba052f75022055a81bd54f40a752a1ee37be80bd018c977ff3d4594778125f911dc6b84811920147304402202ba08efecfde3344cbb02be14f701a5ee3fc9b3e8db26548d44d06d35961bfd402205a164d3fdd8fd014af93e5c19ff5b7608386abd232403d3692630a013cc9632401475221028fe85d93db964e9c6a015bbc1be239df65962bcbd159e27e0a79194895a6f9072102d068305fefea21b971c8706b1cae4dbded610ccdb1680c9a1ba4806b36dd7f5452ae50935f6200000000fffffffd006b000000160014b8cc454f8bdc80dc11d27eea27c6b782c30652b1e977db64dc870be17378547c8097c52e00000000000000016261a2a8626add28"
    val lnMsg = LnMessage.fromHex(hex)
    assert(lnMsg.tlv.isInstanceOf[DLCOfferTLV])
  }

  it must "read accept tlv with a enum contract before the gamma version of the DLC spec" in {
    val hex =
      "a71cbe25516e4a92dbf9a3c792853098c16e81c28e3b44c2c6fb0945ed69c791b71600000000000013880208fee315db2d0900c66789655f250c8650c9fe00f6d4b149510bc46661c899520016001406466dcabe1284c7be019d568e5fe72a1428fb618412d86ce0cc28a20001fda714f56e8f412179d0778600df01000000000101017e1d8bc2126358fa2e903c695090b89053307731888ca42b7eec82d09dff0a0100000000ffffffff025cc10000000000001600145c1b877c6d2efa6df5cf660260bf5429de52bbff301e050000000000160014ca7b8f68b1c8cf479d1fdfc1ea4bdb319e45ff8f0248304502210092e4ee2fe01811f76de10d3517c54ff6813ba697719edb7f1d12a51765d26b98022016b96da96044ea79828226a82c2f059f6865d850d5e4c50611dde96a11d371ca0121026363b61aa5f1ba490f25a90d60b381a660872a05bd7f7f16ed8ecd14a33c8b400000000000000000fffffffd006b000000160014d0eb5f4d0e9337a23e392bd5bd02210510ab5b68ab0a07a79fc975c2fda716fd01450202523b0c87f94cc5a8cb951e5bc8bf76a9cbf112b37738661cc0a0239cc135b58002b80e47f2ca9aa2c7bed820cd12a2344db6e616ca1ca309c233e99404279974bc1c9004bbcdb367ef265d2bbbc08a823cf70f760144a965974ac456fe9cbbe5f338503f6a964413006d97f93b721a859ba3fd92c21732b3812e18799720f827b1ab599425f453828c55c486681ecc4449abac97b21879b00bda8b01e22478d18f02007aeaa7bbf45900c2ba886ac62896f1d43350decdf173ca9c444c04d97bfac203c0bf84221c503e01a6ae0e664e2915cff1487ab0464a6a7b331c31c5d36eff5bd60675c905f7a0e6c5a5a16b65045aff705baa2d5d81a11e4a31995b88b9722669d547c85c6802d405b4b86faa421d814b23ddc623431b03c710b8336997937b8d9915058b5f01a7683936e83ae03231ca1af44132aeea4c004601079497a4e93000d970927440ceea4c436445af10c1da1118234901d01387de92c616aaa3d55ea3e4ca372826d16deddbe6a829db92957f2430519be7e58eacec7bf5854fb4fdd82600"
    val lnMsg = LnMessage.fromHex(hex)
    assert(lnMsg.tlv.isInstanceOf[DLCAcceptTLV])
  }

  it must "read a sign tlv with a enum contract before the gamma version of the DLC spec" in {
    val hex =
      "a71e3d16ac886a9f4ab32bf23a54935359e1a1bb9689bc454b325218c0f87f239702fda716fd014502021cde85747ed5b9e2bf8dd331254bb1d6142602dff0a8e82c7653fd52b05b97a20241fe0ff3ee7b72de965d7f78137c532c3d1764cc5cba5c5abe656dd79dc438e58dfc34e5e02a5822884934af97381974e26f86868ac5a2a8f26868ac4ef3bd155dc4471dd935f0eddd03dddc2a6838e0e3dbf2689be51b5d4669f1ba9f6775f236d10a1986eb5acfc7791d352b6971304baa367ee510533676599f87cbe822cb02bd98a0ee88f7e4b8373f64eba36299f77d5980b3b5708e235819965e41f1a9da02cc37693fb3407144fdb2e67385f8dc1fe4686233d728d6990faa58df58dfab081da800aba3d8ab1c2e444aec33f5ecd73f08ebbec1b16d4dc667cac51983425bebfba4e45b186d4ec9ad52f24ce354aab45d1af874d26e6e62add1c288f85ef0c2ec9832622c641e4504355aa580eabe91c2dc2032a9f4c03cc77956cbd7bb246a6e4fd00c1a9144da68a33353bd869aaf914534e15133e038e4266b847fab9a78607d0ffc23d7f06aa4a6dadb09b1daecc8e42859271d231e454d5e9ca62422fda718de000200020047304402200b1b158c47bfd14e0bf910d1a46b7aa24c496136a545a5711f860de9111aadd20220587e269acc3ee65616cf83a94799b0946f502c3ed439dbfc2b72dd0a83cb67f1010021022b9f1ce1b953c64307aca94e1aa4aa997333606b47f6ef9c62da21d1a2299035000200473044022027d4e6fb1a028e9917fc5ea56a277aeed897ef7d0d6f1bf3014f7f342ca4ae7802202644e33fab903fdafdb2cf45b48efc31e1d7cebca98b97363192353a2d8696230100210340055e754deadb6dc5c8c685de8dd6a9ec8d33069fed47c9c7dbd5cd059c4352"
    val lnMsg = LnMessage.fromHex(hex)
    assert(lnMsg.tlv.isInstanceOf[DLCSignTLV])
  }

  it must "read offer tlv with a numeric contract before the gamma version of the DLC spec" in {
    //https://oracle.suredbits.com/contract/numeric/cc73a33c13ff5e8a1b5b2e29f70fec357397148a2f75fc96fbf1db24415362b4
    val hex =
      "a71a006fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000fdd82efd019800000000000186a0fda7202c0006fda72620000200fe000186a00000fda7280200001ffdc3500000fda7280200003f000000fda724020000fda712fd015afdd824fd01548903d5b386f8bef73d4c661ea9572408a57409095111f1c19bd2ee122f99600f39942aa6370ed6c25a97dfdd4257ffa09a38dcc1a8a02bee676b1922d84092425d1bcfab252c6dd9edd7aea4c5eeeef138f7ff7346061ea40143a9f5ae80baa9fdd822f00006bc454e6fccfb0b3f6552f93518725d56898b1eec16f44d5f1d2893e3ed4ddb7a0fbc3e3a4fcab6bf29e5e074b34051ef4d2089509f8134a538c55e215aedcaa3ba41d1b8dc1a58338ad864316039b8b0e9e7fd2e4f26c5601e37f884be1257abe581c61006f0abff598c4f22a4004eed279f0892545f78b202238bf23e28630d17f7ac7611f5e9c295c3aa192d34413679d180e3fdd0fbfb1d69bb373239d2b452364c34e40c347a9ca44801d654c62fccfa03a9e2b2445f800f022cec8d29b461789680fdd80a100002000650656f706c65000000000006155346204269746465767320617474656e64616e636502bdec57ac556924495176e751427dd14adeeb13b895b5009d379d5d019582be3800160014a0b9ae61de0f607e039d95b415496c55d8e3c977eaddeb854214444000000000000186a00002fda714fd02474441a1d8dc570bec0231020000000001030a0c788c2b86781ccd1c1567d2e1223adc4daf7c5549aa2ff090f994fc3dcdd00000000000fdffffffe0ed4137a4e386c3fc843b0f21ba2aea2647aa7d70642ef016743cfb4aaf965b0000000000fdffffff65c6f3f43255fcb90da9de0304638b244d3936b734d51ef13cecef0b4b8f035d0000000000fdffffff03cae90d0000000000160014a6400e4cf7321e42690d4f6b5ab758913a243f3af2890100000000002200207bf94589e9cb1ded813a70c40d4c89b7c472d66c3c2a6b823c6c62eba8a78cd57029db0000000000160014bd7fb1ab8601905e8dd2c5ee149c54302815628d02473044022100be997e7db0a38f224e331a48a235dd058991e024fb8acedcd6d3c0c1fc7134db021f492d42ce924bdfd30e9c15853886740f484250194c5bf5aa2f1e6bea7f5e85012102b082f762acd754ddcf7e9dab4454f03d4ff02297b84ef51a99d80981e0ae9c4d0247304402203913076ed6ac4922ae182b9b37a9ac0c1fe7c2c9e84230ae03b8f52594b33f0702201d8d61707a10415bc40103e24ca456f630def0890821e2688fcee6ada20aeba5012102b7cd5da821101b71b398c09976493634d5c01303c6f1efe47fea81e43498e7640247304402205f8cf40a013e1a9d1b15f22280df913d855f521e8fd526e0a53da8b58db37fe8022065611e65380fc2756d13bbb77a5154cae60365a893151be1b6a60674ff2c1e5601210386dab24146f5430e973949c391e9d9eefacbcfca124db2e00841995c36060a120000000000000000fffffffd006b0000fda714fd0163604376dbcb6e0035014d020000000001011c62cf6fc5dd422a29df0c98bb9aae24dce5df4025fb3f42326029037e79a6130100000000feffffff02e038000000000000160014c990ae8fd4957ab7c17bdea1e580d228586ca42ec04d0100000000001600141042595a8ff9650cdafc51309f52c783ac1b5169040047304402204a9d85d56d25446ecd78227a4828092b33fe39daf09aa7a2da05d1891f94c00802206e335fbae575ebe9b8ade110a2ebdc860d3c75f101d8bea736c01bf7035b535301473044022005b4c63350a6f06a52c2b66e58ebbd0f4025f5a037512d2d846bd7e68a787bd70220767f272e17d176a4f684cbe223fb6a400c5fb3638c5fc2767397539c1fbf1d4a01475221020a2df205bf00f5a216b6f1fe2cf124295fe0ad55956a8b2c279af56ac300413821034cb9c538f38438382926eabcd2d83daf097f8302cf697a693728d3feca88ffc752ae8089c16100000001fffffffd006b00000016001475737a23fea752b72e2eddc7ec87c891278187a25becd552783549168badd3b32ce6e16c0000000000000001000b447d62940900"
    val lnMsg = LnMessage.fromHex(hex)
    assert(lnMsg.tlv.isInstanceOf[DLCOfferTLV])
  }

  it must "read accept tlv with a numeric contract before the gamma version of the DLC spec" in {
    //https://oracle.suredbits.com/contract/numeric/cc73a33c13ff5e8a1b5b2e29f70fec357397148a2f75fc96fbf1db24415362b4
    val hex =
      "a71c92812a8ad99ac582dde6591ec7fcd9171de9ab9fadd97f5d2bca58c2f928eae0000000000000000002c6f8499c9f208313f11be7c83d585783d6a542a393ea74cbd0c62d01d98e255e00160014195f906bcfe23c45c12c312fc0e40c1ec474aacce8f482d2043e8d980001fda714fd02473c6c613323c5e128023102000000000103d71dd926f5075b420d833e9e614fbd25fa9b9d28ffdd095523695692b89e1c300000000000fdffffff844fc6700dbef77bdbf556fec43ef78427eb850f3b7c0798902df72b5d92cd840000000000fdffffffae2994b88d570ca62641bd6d0d0fc7b07f134f85b3ee271d60d6175b816e602d0200000000fdffffff039c8a010000000000220020d1743103ab9ec5e7a2c35a8764f0b7dd0b9110555fc3449537722cf6e61e139f3a82080000000000160014969af8b75224db10a48e08a2ea67fb986d4d9c996db8000000000000160014cd90f24754a44027a9aa656dd9494d1454dad7f50247304402200403ef0f26e7cdc51e6213a12ab1ab977d26a8b19743e1fb988b2133f57d7eaf02204e27cc13332a2328a2a5594a468518e527fc3646442b62a78f3e1572c8e1dd4001210209594686ccf1fa63bafa9bd9d263b517a4628e40264a36eb899242cf4c68d8a102473044022027f3a84e9cae1859bbd03bd216ed066b42da45d47dd6ec670e9dcfaf6489602e02200ceea6fd1b0ffdf5ddce973570210c6ca500718375276d0496e5447630a899ae012102029ee424b101e2321699f879b64d135f7b3465e9e385c18c46c3006c69144c9a0247304402204d2d3c5e72da3e68a0e8ecd9fe8b01c5b9f9b046d54bb1ce45eac8881a20dd4002207e87f5930efec53b8319ed7fb1416a9283e183fd99071fe383daec5dcb1d9141012103d570f17c745947f04042f8de4f84557d9b167a30159a5b598d17d4b0696fd1a60000000000000001fffffffd006b00000016001444d1dc98b34aceb4de6efe4778c7447ad8e7539f251dff080f2111f7fda716fd28814002bfb8c814147241359b1d979898751641e58f934c28d0f68338543d67c37658910246d9ebff722104fb2a4548fdba0816ed16e59469236afa0d5894993640075dcfa8336c969a7ab2f1a8d59aafa5cffb0071093b5b6862590946be45d2b500d618f50e51d54fc4c63948f6181f5b868775700f3f0a45123aec7fbde133036d4fc6e63cc2d97376a85885fdfb0960bd0a5d0063a8dc30986f17367af36b61cffd18027362f14ed1d8c1e4928b5c1aa0e56dc215757b9da9f0bc26e5d1a263a2e60b5002e8dd6430c87f44aca7d47974fde736b32c1ca4ff245808ed8b7d04790c69f4046cace2c5f97cf394e78f71d06972603f459d3f100ab3f6469633e637238882bf40eb87d3d260dd56a54014d96042a4fd1981306f15f42e7cea4050957007f74c0206dfe9dcd9a334ac30eab011720ab13180d23343a5bfcd6a3529c926704c4c026cc385783e9f3fafdee2a8b4aa9b25a0498e76b925cb675bfa20557a57d4f76003a4915cb751113978ab05378fac7b7c6dfe5c1d156100c0b8e6fc6d3cf023a7885f70db453fc4b09d90deadc409322dc30653dd90062cf79a83cd8269ef71158c4fc4ff384b01447a30491fe88ab290d2413e0d9c2e9fe07439fb40e41092caf0642ad9a5af57d3c81bd91610289033cef91115b9223b7a029cd3f9704ff5c25a0341d62e2b4e1465828e9070b53c4cc74868447175dd14e2de0dff2e82c3d0cde20203bd5213b8a2f553a1aecaa288aefa162ae18b7950bc2341e2aa3414ee09fa8b94ca63616891b668633c73bed8363dca654762920eeb99fe539ff16f9a1dcda9970b3c68c08711be8bf55ab83a77b7395f0b6ccfc5d931e733228d7fceeffc42699664da3dfcac494a6b02f39af0d79d7f1e32d84be3e87e93346165d6578813024b600e3b88938d11d4e7b66b0eb2d749c111f0d25c7e1ee1abe0661b10a10d5c02584db3ac1033a343d708daf4fb290f799691be4bba7d1c0185df0d5a05e72e39d6634a4d4f1b494d7a67f22ad34d5020574ab6f81d46b669b3471181a02497c7858d7038eaa438573ac457f9def55e00904a50f4d897ab118dfe4c986c9ff6582fccbcda323ebdcc9e912e13f14ff5a7031c8811577eb14929f16c0074522953034e16f11caf7f1b4c7b89be0b070b47ee73b1a6e21a5eaca24f46ad49b41c381d0320e08443b146a719d27771b7adb232027441ad59869799f69e0a0e0b5c83f0501566c853a75188d37408e69598aff07f402d3fd8cf292acffb494b7e44620f010e58ca679a1940a03cf72e8524e153cb8bcf6a17630c01f49c245b5a4c2a21a1611d63b61249da59bc6812937286e23e0a6c819449dd504f5ffb8cf1311fdd93027d7f6907a83c01bc3a1339bbf6a052191c6973ae54e3b9a7af9722d0ba4cb97802018a96e0e8d362d5fa2a73493dfa3107c0b9fd38761cf4a66b59aaa4ce8f99f6a40158019ce363783e49ce567926f4d80a3091b1ff7631ca3e51b46f524fbaaca25a982f05e49ce897e758220bb80948caad19c28e99194d59c60916d9a659c1f46b2c48473d49429584e55ebce5e69e1bba3c9c5f1086aef71e166bd917870d031c21d879f28be326e129ac9ad1c87eb0f05b76caf3dcfdba24b6e8f395cfe0c203658dec90059f292ce0aa96e8f84efe45b1590dceb40b020d3c3fd580100bb9bdd0163b15ba59905960783b691d1df1c96e714163df73b37f39526057fde79548b4c9776daf09cb176c32ea713815f316b711f679e87d65474ed129f580d6271210af995046109ed313efe0055e6491974e1c7eb87077e782d63f18efa59fcbd303fa391efaf552239b587ee2575bde4268019d27ecfb8a296965c8cc8c1e0ee03502e2077002a93daf587c5dd65b827ac52927a7c0b615a6335e0c5c5af78953bee7490eded7aa926d7468b7ee15b874032e06a83bb3581ef5f01db41e2934c799e5eddd47e0c10fbcd7590cb469f095d542ee0bbc38b060e7f0072d3bfcd559ca0f99db6d19912a757e27ab7c3fd1ab1c0262c3a7615959949c6a127592235b7c6f02c0515ebb54f43af92b5183edc1a6b1163ce8d187e73ba6808c6f1300d7d4ca7302cc7de0f36b0ae0b77a35e10567ad987a5d27328edf7534a3c091587cc14f48c783ae7b246b46d01253d00628b683043ec531fd41071c5a4b3974bd6a0e44cee4610f9741f9035caa0188cdfca241b068cf4d8007188198faac9dc46b7461348d0922aa9a16790a9fffd2ccded52bcda0a85837192cb686672a255a7be249725302fd956f10f57fe933e3909f99ac6d432b605cf49cb70d033a13660573ba0212bb02aa057a45eb87d6f78b06348a11c6113d070210d713417d7c0d6c76d948a8c83cbba12eef459bf00f617277baf6fe35fbe912d93d74441736309cbe7fbbfcace1e09be942be4d20d40313f0aa58310149e3d6a25dcf6a2b4275540b3a413ca58afdc6b17005c5ec646136ab6a9322b8a196b226eaa294d232337764de102c08e303977a5cef1c53baac155014181eedfd6d5648596fb4a55d21532c1d47657e6671020f1e6dd1dbe9dd826daea3d85071583e709f81ae642f69bc371387335c4c1a1662f82cb82466f5b08b06b57c46b5494695cf62cb1adde758a25659bcac2b8ee009d9a6417b155a45ec23960d8b496d2e47d9304abc520ad6257d65326b3367388fd2bd8d7d497f5ae5b7cccfc9c64a3da9b905b514b21a4237a2f440c8dfbf29027d019c0df58656bfdec351b24fd30e84a7407c084940f9a5066da3dfd7c092f603e91d576b4bbabae1df943e747990156d17b33d931a06b6122126db23f0d879d5319acb1422710cefb1cf9f95b93229690fcde29d437d762d45ecc086756d47c9c65caa763ffcc5cea297ce921516aa880535bb1d52fa48accd9f254dc5c2608c6c005935a924c7da8394f99df2bff44f82073eb972a14e678dfc63b92edf057c03ee171a46e9b6dd34cac9a479009361c70a651821c5944e327101e75fdccda6a603e119942ae95d74e8159c16bfeed190f69a6658e46a48568b4d63a1fbaad4eded60d9d80071085cac28cfddf340d81a6a239f2ca2f6d88e5dc19e9261e4c3f1932209156107d7cc8e0048a1f538fce2c8559ec4a2e6b8008cc6aa05b184155b5c000b8a7147ab9254d9a47343422c283eff70a366422cd719ba99d275bc9821c603d250fb96081f680f07ec8a5c02d44c448273ee9897ec5d01e2d71d48948b2a6c0396ee02738c4cd8e90eed983c60e957544677f8e1f7a8499bdc7703899068d4735fa5bbf4e6f7e14cf1c0c6c882fcb313db7fa340772dc1886161d7c56a82b528345dbe1f97a1b10d293881233a8a35cc1de8879dd94b3971821a18413e9aae5478cfeee144838479459241591e0e5039c2d23eaf2f89c366821405b5b322b1ae028348eef4d0ecf838cf60c630f14ae8b16a64a83cce77fa915c8a204ee6d0d44a02347531fd1c7547431a581dcb9a78d32a47df7f4dd9dfdfcee3a34e841ab37629ee387224ef937cb8bf13fbb6b84ac4aa92133481c89da285d9e447c262523c510b4a548b11bbef31c2e858cf508326b5cbbaeb99bdb9ce130b9f6d5f77edb08b3f24950761b6fcc6a0cb379c73300311ce627947d692c44a71130f6ea9b9f7e602250551a726d9c9b124b9414c7a232114a994ee6a90c3a4ccd4a3e3bdb8711ddf032fe4cd08b9da24955b24b649ccc65e3da9a13ab54d50567d96d5a275698def3e1f33d8ea7c51b731a5669997556b3aedadd8a6e99fdfc00c202fdb42820dc56fe86b821949674d37ecd52eb2c5df5d78aec2a58d2d8bb78fd231cf77bb9c84af75432b0e2dafa7cb256a02342d37de1aabd51c3bcfe88fc3e212223199f5289f02ca1684fbf746163b2de5c0e9c595fecf617dee5c45ee553f5828d698317dd2d2039db150ea74f83a03d55195440122e64a12c3af746f2dcb58d0a4ebb4b523f341591976dfd6ac902d52c15588baef4a80184641d92737a471158404952690b99249a2f4476cf860303d9666a0eb40004fb2df03cf9c8a4275705cfbd40926edf4121847abab136747a1d4ce1c8ff26f70bc95fb416b1f8fecdbcd192c5a5bf31802e519c9c11da2a11462abfd6d82e74e36df4047c75b3813f74eff3ce7e7b2325c037be5d9c74eea185fdf64a7973ae02fe6750fdfab8c7a24f1201a7b195fbaa78bfaaeaa143bf3341e2936d86f6a94504c82e0457f89d408d26b95f8f2bd97c96b1f8f9e3f4d8ae251bd3a6c889e0bb0ba30f9013c9635d85cf4665b5220ceb0d15ac6816b8ec054848d74a8f8a15d4a7729d55580c852c7e242bd815fa5d50e82034fc773ac817cb0ebe2ea5c8a9ddb9f5694b1fade13371415381ccdec9106f7d503282dc3781a56774cb5aa18290f1b84208979a342f478a5fd5af6ff57c79741044ad32f809f5ded463c41e03de7537369b0b029ee9b5a2aabc5b91ed0f4dc03596fb3884686e6a4db86a9ffc03a39331798d53fcb6c1b1d098c684d15fb6a06a7bc52f317faa049ac3a5ab0ffe349654ef0f5f8a0d040ce4614126cd76745853f0382b1584028ace8430884d2dd007b8c1d788013c9dd214ddd59f9f1388e9bdb7c024e6c4c9e8151ddeb9ad3768f9893903f2be6d83a9f34bd6ea488dc8fcec8f8fb39ae3f1afbca068095edd35c118bf5d562fd921c3dd186581f544c6851b8482bf53f2b554eaa191a778c4645012dd8cc34b8c8c47d6a6b411378bd4874507aedc75f1cf9b3aa0bbba5a66d358fd17e74b87e503f9e525a5c4e968218837d6c1403b4ef87a05729005dd61581419d541061da3f629026b71de149fe3c3caafde096026f876a32f74aa39b7866fca417e70170cea79b352b792537441fa96a084345b3f51d97fc465b63ff2c62c00fe0c621b2b2750447c55ef6bf0f0c405bcd1eac2facc6a8e3b6082e6d0d5c2eecfc9bc3968dfdf3cf2003d16a57e7f393f8259eb43a462ff1d9febf11b11a9995c61f6f15ff773bdf68a7c86388031dfb20fe588d03d4d3f114d3a9a53476924bc7f82e7b0eaa1d0b1e81104255fe12ecbff2a13bc302861642e6a78964d704cfa368e8609d254a132a195cefef6043a694b2264ce63e430335de82c518dd0358d28f428d93980da5f4306666805f1b0973d0cde12242eaad8269597cedc11d4a34ddb27350e1bb22fc7670662f955570b6a514a07b5d1b54dbe8d36f8cc95fd5ce394325758115c9a7d0ecf9ef7e6e0157d0321475b403e7a26e5921b6c6325ef1d5ec09f4d2f7aab069a9d2b77dca47dfbceb630ed56802223e5db462a519ca95f9ad211b7f4b870b4f48ab5969857fd96ad305715baf773c5e12ceb0772a1c20dc0120695dc47e68e36f23e624c338342372515f063a042343a9cbe83aab5b1d458dd5031c8756899e8eb24b88758495b0b0eed1da81f69d6291e3bbd0fd1f06dfcd97e712eeef0610a5d3ece2d766a7fce00d45c569a102c2660b5edda4520584b70a0d6060530d3ea0a1eab35ff164c7516d390fda559d02e12d779db3d23652bbc88b14843e7b7f79a0548e6ebec466a55d9fe4222f021c9530eaf13609220f9ae9c3a6bf96f40a85df395ea321689ab964f3f939277201839e4b98a1ceba204b6aa880ac042714f52824c35faf45d6a73a88309cd83f056c0bca13d57cdd454420263246872cd8af11571d3302c9d2ba0b85eae64889a3028461676fcb2d6f00863d135cbd89307a1e9dac08680a3611765bfdb5054a23c203bc5c10fd3d621ce3718be47653a2189aa89859c72d977c25198ce8c56dbcbd29466a11b6ebed3c8995d442384465c1a8f69a2ecc4194d66319e1d207467d29ac786c6bb16ecdb2eef593920ff5774f3f8fa1cb0555d4129f5d24b48fa522f30cfaf72a508280488234faac381b1e1416c3de3d05dd256e0a94fd08aa99b5e526036ca925f614052665209386723bbb2581654ab4521cb381e86d298ff5e94513cf03fdd035552a03b2f3840da23993f64d365abe1216b505cb603c364f806a8f016e4dff3c8bfd9253c64635f58e660e36055c0453aecf4974fc15f8a9723708a938f3d6e089416abc113524910d9f48cb785fe801f4c84a1bb8add17112dbce55ac569cc0ebe119cad29006e67c00b0000806cf4bc39c47675d9bbcc4422b8e80f903ab3f15e4cb8b65252ee44baad68f5ea5b97147a8f0cd2ed59dac066359ec890803f418a97165614f3ca25250b74dbb06e9cc0dbdadb3c3b903c957b9b6945368fa4d43b98f90e836b921a40e9a4b3e25956d90c3f62f1754b456662325487f2d85aa96af06812fee56ea63abd5fed93c0cb2e5f254d43fdc1ddc9cc32775d436cf7d38ab7a1d705b4cee56ac4a52e89f6d493b59e079ce5f3898f5d69277bc130902cd8a4356c177ef456e73d0d7e3ee362839d4c2c4a105c9950a02094c7455ba90036edd39eb5b1769a715a480c27f26602dd0ec603f39c6d053d4d767681bba176ae24805c69a64423781e23adafb16e2c8b2b3e84900efff2876a142f3b2626a203fd455625a94e38b2e455c42ad9ce89e0fc0c7a141a94a958b9058bab9b825e3b867a349efc5e6df0aba51f084401f28300ac00d17527f38b2e3c4cedde85e3202de23542d94f499bac4b53a2e67c276f971aaba8ac2279bda8fbcfae219a3c5370263c172bc2cde0e14631a63571850ee1535dbaed90a8a25b1d018d297e8b47fcf74a5a1ba424b489697a16919272324d7ca617f44bdd1132350bef0cbabdf66598f2d1e91abe9e17ad4ad5e4e6b071b400b5ae3dece6c5d2461226fd6c27ffc4892f05deda2e6dea9d517cbcfda98368d9790eba945bc3aa7e87b51b90f3358e80396f48c26f1da6a7f5db469f8ce9e53735eaba1566ff6ebc3a9b440bba9bad1f803e1853ea9aab61a5ab648ab02a85091269934ef174ba0a56f42a3d57861d28e5cb25b1bca407bd78a8e99296363ea9d2b4ae4bbbab67b5d929d51a28a9151f7cec6071e9e8d3f957d13cfc8f68b8afaef48391dabb22e28149bbb29bf0440b5b0293148f43cace0b5fb089036f7b18f8a022bee56def8d388a87c7d9f9a8e8c42029176cf46ae4063ec54c5062f5ec2f744427140020a99426763d73bd1c2f05a3f02eb7bdffe8c9849e01dbba94d43cdcb7117dc36751198f69a01d6e8580e97983f65db470bf4600eb9f617d734f18f98012de6e157f57464511bf77275384560cfcd0db6d6d738bef1183b095252dad2e097fe7cd774763af3eb484a5d9f00aa197b73aa26609168add31b04897ef72c4396763c53d399b8d63e4956ceedc8a9e6028311753dd832cdc156223f7e17c25e99de9700c40ca8511fe593a1ac9c1e0b3e0376471ff2f4b5a71ef7a57944f6b191bf8cb5bfbe4e024372b00eb3d714e0dd6fab20a75c30412a696abf2f01f4ae54af8ad558bd84b703121f4b4baa14d6eaf17053a1d6937e86938d841d662f6517ed0e11f419469a0533c3490ec9fa6840c5fade9f4e89a954623ac5df03bed5c87d97e1c99802599a40ce1ea609a7b6308202b01055b1391b0a56cf24c555a33061c8330e471902302039969bdffaa50d296903492415a71d9ae1845b52b97d6c65dbd4ddc59a31b398354eda57575b5cb4a4464f285104573df4e522805671dbe79366ce0dd78e8a301c4951d4b5aab0b99e15982fe6caecaa9cac5be1456dda56e186817d506925039b38e67890da8489ae4360fbd1259d42247df66d025f83561267a70d1bf11472df6e6c72a7dd02130b6b0254546115a5f6dab7284604b9ff83b9d0b76955da72aa7894f76c02f06cc766f103cb4097b14da12abe4e84ca4259934f11c191993657efdf4985778054079006f030379a7aae6006fd84402f4e74a60b5f623ef1af50d72c671872fe86181fc468a66b8abaf5ebbe0276aff5ce14ca1c2c863578060f21dc1d4d83455d0b8cf4ee32fda2ad23517486d6207ae2a20e48ad0d98b6d2f2aefde4842b4bf38927212f020d0203a25dce027921c727a320edc99fbc56278dc254a21b4f3b160ba87f3e2c038c28b31f4838ac2fd7970f1aa63cd585bfb5252e92e23793abd09aa7abc300949e4a9ae57a151e1fc9c6da55c481f9e364d170ef6daa2b3d0f7281fb5917d110deb40efe37101e305aaecf4888f53aad90c8ccfbdb4a26311e77bc0974a565371af8c4cc82eee50b22d5b32b5005473e5d734695df76605aded87de0d4b6522c02955ff8e6a9d82574514494882835e31771cd0a1d8ff07d1ca8993ea5c0a5c52202f95559faf0aaa248a5edf32f068f565fbeb3216c2d8b7043e279b0ad82b75bbd4285eee30cbc8d44ae4ddf392be09e271d087ba0230dc99c9ed7e04dd04da2ce60f9657798f596ad01d0635434bd130e3620a8387cccddc723362b6461e478f6b14a7cc6cd6fe4d905fd9178153a5e272a4269cf8651992df58b4c82972a00ef0295d62048143b2889502cbf810c0a63aa2c7a8d37ef34f889671675e28d27c970039ab344be3de38a3c1994459b288aa4cf0a8c3b28fbd6818dac321f979278a0af515cec962b3da4f7b42b8ee191a1e86fe01c8cbe60814c58aa6890c1130955a93f7a4aa0053ca79d1dec1e6be569d8fab1f5214bba960bb2cfe79245fb959ef5f248cd867c9a509848d3b65e974f38132688fa074f93f06eab13c51c8ad9fbf403fd9410290f6dfd8d548bf5d13c7072c29c042755391dd92c1d3f6b4338de2eec02dea8cf6eb4033a28ab2e5a2788449d9af6d259a827acd87c8dbd8cd05070228e628b6c6743ed3a81d0b1abc3d56bfb334bb91e68728cf40fc9d0a13b1139e5cd298e721ceaa9936ab608e98904050caa1157d6c64c753f6b17b1ef635178fec27837cd13c127a15136def9009e992107ec14e05d1eb817413b74773afc94326503aec51994c17862ed20c233858ca586dec7a7846e1c1468b6f8edc1b833096ceb032d6c944956ec764c20175423524631bd5882369d50abe042befbc12a886d9b33a3539c66aa817592ba23ccc6ebeb30dee16891fc2b36da278fe76961739a29cba9ec2e45d94cded5460395f7a89fe25f8a6c6bbd7b202d93ac47f8d78f5da0118a5a0ab452e79c56f1d83e368bcd0532c0123b311b822717fb0ac363e27b6d0203a46728420db2d3d2a2fce19bf2697b95ed34f9bacf8097724b41c26852c2a20b03ecfed52ad67c923409d034c8194b7b2642c3ba8a18e37903dcf0019d6c314c35c7460ef960068e0a29cc8a5341578187d8073ab2f8053309423626a48d8ae8b05606834e9ff47a64a242238f428654d37e34bfcb886a931a671cdd5de80d338a0fb674f02e2f4e611c0ebf259655aaba48dcd44d1e4ef79359377069e646d946039a77dbcb4127f313086ce0aa284b56960e855cd4f62538cd7f0fa5066c776335029aa59078c63078c47a28302876e2c1efbf0952e26353927a43a13832d9e8857a3669c16e1b08381b40def6c485f8f3b19f61d6c182e9faca81f88c2aafeea406c3903d14d1900add28700d844a761ef06068b7cd2748125a2c56698d45e7787bae99599e29c81fb403cd1fa9e03df1cc7de9679d4f938155cabe17bb3b3829f80223c8712aff53c64a8ff2ed36c669edcba3798a80c1212ce3b56c7c81d961dafb03674985d4e642f3b20d0829a3c5d4e2245aa1c3a348d9cc77e6c3919725eef121773f9dde338428fc24942c0f7bf3a26981e561ec5a40e14434ce052e861ed3b0fd0b2b9efc3f8e52678b76c74f12d2658b99742f8bee8789b325f8f65060bb4fbe8c60c5f91cdafc3242a2101bd46400770d9ca2b8eb1166d4e13123d5d84bb102100818fb267d05096c5391ce18a23f3c593ccf244155a4283500cbc33c07636d03d1a40d996fe7f4ca1ba59585614ac65866e0b29730889a83ee446cc7f54fc6b583924d1ccf5a3ab80740f875a8e13a8b769e9ff66fcacd0dbab969022ce3426c7bfef13f070e1b2f5ffa19c207ac589a75d55901ce5dc11de405085daa1c03865e01553b21573f0426acd28fa2c79a21f84c45ee9a126dee52108c3351bc1bc90365dc7d53854cf0cab0bf3035321a08190cbd1ac4eb6c1828ba70393dfcdb00f4036cfe3f91e1584b0623eecc7f4f67ad3e7d290b7cd35b2658b33830d8c1828c8ddc5011fb8e9cad14aa86602b83cc3a392b328ed4c229bc498f20a87f405a9a194e5641d018793d0bec7b7d95e2fac469ecb3895c3a47da3da4cd3e2775f2c71911f05fa64fc67f890e29ddf8799e67aede1ddd2d0c7ab77a5fd1f049f9754ef602c42ad1ed65493e06536763e6177fafe017b30675f2b8e2733fa98ff3568d14fd02cb112fae8ec3cd8cd9190a6f73762cdd727603d070b00c4a335d9fa531843856ef765cf412500fd5cf7e0e302aafe02af656b28f72c81087884634fe4f0fa55510f1c74378961576cdcdd2625bbbf6f433d4227cf0eb2b49e0e62cf24e8083ecf6c2ea36388ca1470a07222a424e8db3a357983a839870e01998e38d927ac26d03caef9523871cd9b115b2baade43c4841a08760ca6af116e08b0c448e3f8e4a1e030493415813cba0aa8b2dfbaac850d088f20ea0ebb2b12dae5b70f98d3e8cc40b4e34c15f35884e2fee8a56aa5c514cf906b459fa7b60308109e1df338980c315710c40c3760247cba1cc706f10e8695f60d91d0914593e5383fca642e9eea4775af2c7e516f7fcf0fa02e530ccdc7f7ed73f27183de0cd8674095ede7fb8b1020233c953d969b0cb97b6be4ed934cd9956bc88fa1282f08ac3a02fba4ba80e47d402f674225db358f180c76d6d2656da3c172e9651fbc362af799c684520344850d1e749db6f67544071d63c774aba9182a5357da27164aba572c13dcfaa080103a66f8b9371c1ff632e8ec9078b9031a948aa20b6d9136160e7b4b57a6d8661ddbb66d7d362b93e1fb20bf33a0f4c12d10547335b63842e7e4c44e34e41166a020303659f60168353d9d227dcb93c0c182a23c333bbc2baf2963953b61d93b8599649028f0ddc04453bf3458c1be8a66c209de04f545c4dfc49d30a5fdd2a0e69b8b855096675a463fa4382a94456cee862c0e4deba5895601451e59e00b0a1c69479c3f38d5e9d0879b7d6d4b75d08a02432fea01c764f8305098fe05906f27cc2f38cdd903cb481c1126c06f1c7a569e4fe604ae15d2964a779b74fa8c7e0b1e6e8560261484aa2eb65762422e99717d8f1b5ddf954ea7ad689dbe9468f800481969d28029080e833662ed8784eeac34dc46840860382685dddbc342cf69fc2a2d2238351d8aeb7c0cb93be3447f2a59d0cd4c615c8da2bc2be045e7dffe231574ee98b162d2e7086b6ce464084d1f47c9f62a25b44ded877dd2869065a5b83d56f73e7b3c0de71ab7e61cd24036b2863c1cb3a3d4e2b5fb53adddeb8e23437c8dcb63b69022d614a3e4244ef8ac85a264bf4fe931554e5cde66722cc1ec9a100437e008b410250d19e821749540b4e07175a14c9a1e133b8e508198a7a15e613672acc6ee186b43eeedd315de719494941e6aadcd4e5f8d38f00212786d78365d877de745f67ca300b512412b5725f25eca7475a4839b550d52c3213dad4d2e8b1bad69a93dbec71f7a6b5bb3f81d921d6dfc3b6ee81503de814228ca9ea951f8e5274e0a21f02b11eb4f4e1f5c49ebbdc97784776e1c6eadfbe58ef926b214d809ecaca4a26fd03be330d09cfcfd356311e345c51acace687a6a396fa4657cfefe1f2e4c0946b0ed66593d9d0f931771963b93b582f68d52dc00e22f8f3dbc9b61bd455bc7b93b681e770f22268d92d5662fb50139b36351d0af68536f981f81d07f08309d3f4fe31f445ccec770e98fd55dcb3e6a82cd0de0d5d74dad1e466f628f00c999e74c203fe9c3458940d903d6e7812e714c1aa7eb5152be824b7f44e8912a85d77ab9b7603e85686be96fd0154b6bf813324c51466989d702d79a52f544c04e9a462ef32aaccafabb4e268606f06e07145ed39ad365550f4e80871bd6af00352a5dec3a11baa1718d826ace6703598e63a102a73ba9b06c6cc2e297eae0ea75f1d8755433330208d57aa06ff5ed0c032866cafd679e7af6a9c4a7ce1945c41577bc05c8b4403ac5dde4725d4281eee3eb78c6efc3f66126301d1f6746bac6ce7a5f4d6738d1603e99df8d88647434556f6a7ead52b74e46f92ac06ed5d307a32e0adfde28616ab631d6ffc2db88fbdc9164bf0104a3c848fd7cf700e06458a0c44a245fedc203e34e8444de3fb4dbf81090d6e2351c2a1c2e48dabea202d46f360b8d9216b6600c67a07002d3d7d2aa988d8560aa3fa8e372a57f57d59a922e991edcfb863b5db037afbedcddc49b9c8e1172151cb3102df37a85cea40185f9409514352c823dacc022a581e05bbd2e3c462623a5599a319d665f7ef358cba9cba5ad38f9f8c66b8d9ff9a6c69eebb2c3cbc12dd5072ced87af5ed268d690ddc517e8a00dcd4d0ea199664b9ee726f18c1b7aa8d51e1adf28cd6123a391aa5ec78cca3afa8c58d59a0582ccf606446672e8557c40f8f8a1cf4f9cced521b8c38ac5561d453b04150e80283519d79bc0311e38ef886ccdf9987861a8a3ddc8c0cf934bb4ade60d316021b035147b611eb92e290e4deb64d80eb1f44bf63b420590104ec68088620c1be2248ee7346a95bd7875bf234bea05f977e9bba9f2910790e0168f951b1e06bb502e7d333ee9bc24ae9f4312ef6edd013ebe14dd4a300467cf3d8dcd3772c443a17c0802d249a95ed298904de3462331bae0af643172bd921b0857d80c14b66e37c380351825ea71af48f7da482dd5085bd45233281728669f5a1e297585aae8d69911303c7a0066a519322d8a5273e13f0e0a7119f23d371f8df62a78ab6c4068b5ae865f59c988d1708c859aa9934a4211f52a4a5550577eed19a02aeece8df5c733c68a38b03931f0b602fed97978d6eabf81025cd63b2b337a897168a82ad91c625d35b3c009652a1dee0b37b9d8079e688a41daa913b6a65ce632d04a961e4eebab003d3fe893a0feffeb65180e107bc314c381281b734e001b8ab941e454c2c309add022b67adce257da1f98e982ca8acfc8ed8db827e13237417be719f3ea4f5b74d97e86b5b2931837fd1aea33b3f84cd2b41fe61d40f722f7c4352bdc097aea0f2e140ca92e0534a080c2684cb2fd23b33d4dc8a783fde498e664f2290429dd60e342c9ff9f243fa4ac5ceb8eb2bd27eb41f06c1a38e80d50c425a125339f78919c5026e2fec6f715897e6357904d9208269ea040e4bbcd8f5f8082634d9622164a245030d0e830e0c3fc8a163b8e06b6e5b4dd6674a10614db8ac60034eadf3732c98a3ea2a46430684ea2be4e462d3820fb3af0a15ca49da731648266c247c332bac0c5bc758c54207c72dd278d4c0624e92a1378a91509a6aff1a59ef319ff8e60bb2c5804eda569cae2b9f491a57cc919a393fe4ad300623e77fb688d09e28587780026948b587cc4f67e0d63baaaa82b31d0b61ac79fdc6ff5f6f0a0fef53da076bcc03a54c8e81922c886fbce00e3fd7101a7c5d49f7ff24082aed405344114db900b85704422ff4f34cf855b8c5050b474b433509271cc22195319854054de21a3535e487c902cb472f0831d8ccdfad55b2aa2a7d5ce6dc4acdd13ead2ace7e12de3cfdc28f2e8526bf1feda1c0ae1ee3f53db24b2afacf6afe1e5421e32f2f0f696103f88382e81d41336103b3ea28c82dd40eb08a58a761b598a95bb3e726827552ee0287436eef4f87b497b74e5145acc67c8b9efd14fd0672e5817cfdab64ff9167f55b0e015f0e29820aa62b45e2a070efba2352f7caac0758d110e42d4c3270b290949409ad0d38bdb20ee0c2e7414cd312e828eed83aa4c44caed494f6ac871e480438259c6adde3b26d243beb628d3e81a7610f3a92d4208104d5e6ac5cb97b2803a612e5f6c08df0c05302c009a1a02c672ca26bbfdefd282281da034716edf726032eb2c6d683591a8873d0e6354cf012a7ecfd49d80fc92729b6a7aa3359132a23f370ff11cd1e583cf1026ebb1d854d7507c7310ed72c834e36204dec8b707347e2a0f14d742925e46a7ba1d13c4839ac57f63bda8e2de0e2d0464c6910b992f153d28e194221bc0621dcb36e5f963e1382d937161017bee03d3df251acdfb4a403745fe8452bea56bea5b63a108b4439b6326c88c8b6a03df58edabb5defc0274d0263309502387c982a1ed5f955f1c622815def6fea99ddbfeceb80ef92a89a303827d024a8c4251eae7ae9c03f030e55d7e041c8f24807b38c728d90e3c17544f584bcc867c8d51e2ab9e5862cab4e9d59cd442615b234c92db25e6aea66fb7b80cc923616730ddfd83831efd4bbd686e6db1ca7cd02090f179ff1d22e2c714a5802645e3acc3fc556a102b485319fbaf0d8b695905298eb241a56bbbec3da0a706602b70407703c90206828b521610b5df8499a1baa097eb475eaa052af8eaf79a2173b61aa88873cf3a3d29e312655d3421932e5a646f6caeca376b6553a5bc4a6b2a0be042ddc29a8dafae21930da346ee00cb940ab48c814771a30802d84fbd672cfc73e9256c28193b8dc8b7cc739be62c4923dbc17f4d71d34ac809fd4f75f742bb2131af4c241a6db02e5a2412c1c54aafc192536b6263a895916765f09a091248ce5fc66b090ab3a2ede3bc656843aeedd3bc5d7ff219389558c597527836bfdd82600"
    val lnMsg = LnMessage.fromHex(hex)
    assert(lnMsg.tlv.isInstanceOf[DLCAcceptTLV])
  }

  it must "read a sign tlv with a numeric contract before the gamma version of the DLC spec" in {
    //https://oracle.suredbits.com/contract/numeric/cc73a33c13ff5e8a1b5b2e29f70fec357397148a2f75fc96fbf1db24415362b4
    val hex =
      "a71e7da19fa2af26521c23aa58ef35322d44c32252fd392da16beb825ecd4c796195fda716fd28814002c633ccb65f9edb2d3011219e99283920ab770b7e90753725bb2af2012882d81b03b186fed612c993a86e39794dbdf60577410e0d1b4a8e358c78455804d89f848f4bc49c22f905861f426ff2a51016b5b2b636056ecdf85e2c98774816971b705fdb79130804c3c25957eb1179f0190cca8a3c6d4324d79d6efd7c4dbabe270f2023641d3a5ab05ca252574a95d723c208afeac2e8e88e6dfc4db525e6b32c3a92026f102d8cb82744cb674f9ab8d75b9392e03df8401eaa41d8ff81ef4492fddb0602e7ad3ae0536e7f7e8e884ede5ae5954d63a5a2860c498fa8d2346953e8822770c547b4ab1344d1af06ddf044e03de7fefe955c501e9ba3545572dcdff48abca7c759b4a61e22a86d7bc9cf15b6a7b53f3ef90b5ece1a7f0dd53aa49772ed215444728948c4a42fbc09322e09cf1a1b0174cbef13cec5b09b3a7206e9811368e80232d117c79ee7f0275f4e06cc9cf5d7184396ffb0960786971a8658723d74180103b0408edbf73b3bf5c0169fb58e73a52dfc6245300ca6205cf7d250326b497f9578c8435aecd91d5999a74e02a0e3de39f3f121713c292783fb59f1acb070b1a9cee9a8e829de0ed5363cec65eccbbb8b35f9060fd1fabafd2e1fd811cb59f9f982fc924ed17a983a93a68e55d040d2b339cebf460bcce0d2ba75aec6bbca0f6202d71d29de94eba06b214a801d23a3ad69bffcf7f918eec679801a71a786fea25702fa367cb263e2166e05493c55955ecb8689de295cbd9394dbc90ca002c190d0ecd49ba7f8cf7118f534da31d9830bf890e34b7ec8f591c67f34a14548295bfc398be998d5b9d31714e116abd385489db023111ed51475bf3f364bd0a26e6c14f48cef7e8ec770fcce73d5ecf032e0ab9806988345a0b3219a0ac271a8219e60df02db8af2a582dc6d9f6aa19ff88a569529bde982c9bb9fda937b2db18f480e013703f0a7439b39d2d2fb30a1334763d2ab4ed8c7d5eac0965978b56812cfb60f8ab10d829db7e18ba9002ed460ba0815ae3414f461a7e8f47a235dac48f6546c814775bdeeaa46051ba471fdaf4419d655030478c2c30b62b1492674420fec7af7589968fec8fe05659fed0527027ce2a7f9b602ce87826182da1c6428004e015554023e70e148fb4d46b0fe5caadaa182e93aaf1d19b15f71ebc61960cc35975751420249b2f7332ca9f81015a2a0b85e579c85ab33978c1f52538daa99000cbbbece5401dbac58fceba7ca51cd5f87110f18a48c81ac091843d2506f62fde9361d44e642a195bb5c4e8c01b8df748a0c368c224a27f7a3d8e68bf2817f440026d302df13fa1b1e7e79661db7bfd174ba828d4563c61ade62d756cc215bdfc18fd33540020e6fdbb4f5143d0a2d37d938516e60b6775c95129467db0fa0bbeb5366e1df1d039ff4802c9aa44a92ceb87f1d7557a667788456629a0cd6ecb71628c16d03acce8870c4e8c8a099b1d217055733743e403560701de4f7b8ae49a4670db3afd75face5f524766eb530bc32d3129dc216752935328204f695d6f5e17c47b7eb679a6becacf0ffe7bbbbcbf09e5dc63ad3eaef2eb012e58f9bdf6c93e9d43c940917038f15620a89a3cfc5c200060dd0709c8947cb09182897356bb8c5cf0c236e5bba02c65e3a8c4632c33b86a3592e3372c229e242d4e567a8479f74442664dc823a5cf613b6546818c0df6289b3f48e0bc040b6066ca1374483b3522d1a50d94b2ba42d79c9bbc7d12df221b402e364dc84e50c5db165e1812254c0ebbdef281ed38f50863834f10c95a3d3ec3565a2bfe31087536eb25d23fbc22d0a35748de9637c03685b7d366773041df77a8304b4402f2c90fab5139cb15bf2f43ccfd3da4dab0d02f436b21d9aef3af77a4a1a64ecdc42b5879077f0b7ed3bd6a0e80c59cfb6d77f0b33e184fb5336345ffcca43e26af81138aa69b7841e27f4cdcafca77bd65e37af95adbca5ede45f2c302f38088e75c35bd4e828a101978a9de82d1bbb20cd400a3cbc7464644e06694e2c00fbdda0ce07906e59d641c66c0702be637bc0284f03f1d809af72eb71fd5abcf9e55ace559a25193c31622544c21c40d29b6bb9dcda031e458509d8160c6f6a218b878ae0281b9a29382a8ac620930b1fc17aeb221082e00d120184af4a21716f603d5305319ec11ca32831c7f2584029fb266e2348a5714aa319f4c00468fa6eba8e0c388686349ae5942fe0d7716acf4507a81d4a35b7a69841448c344f7500f6386a887d3493da99fa4d0298684050e4ba9e7ae0940280c022f78beb47016684d4b908fc31fbad220f23fd1271a13be690fd11a63853020c4b942052c1f3dcd7157634769640f0149cd79dedee27c3dbacc376a7f2d268f9667c67b564def178875cf2eb1229a931ad867555418c011721500e6af067ebf8e6011db35ad2540c4906149902ad030cf9b4fbdced049d7100b58418f704be5de0a7689f173ba73968e29ffa599bfaca62385153e99a9afcb3d6ea4cd5be25030ff022478db99302243822757dfb029869d59ee9b52143536ded4396b2248a1903c615b64a7b2122c94762e3abb06878fc2db9f3e1d61211bd7a9a14e45717d4a0ae3d5d9693168b880451e0679549815804265263cb6a15865c19c65dc58acdcecd962dd5586a343b43d58ac5535d757ac5b273967912c25598713fd98d175fd5a425cdd3b0500b5fc6a702c613a9bcfbd90073d3fd4608b781013866e5cd873102a50bd3cade3f50fd8ff4cb2907a0350d89ee1d13287eed2d73a2a043d3b73767023aa1566c76030c73a86223c1afd56811b4090edc794380e6bf2652509b1805b9baefe2ea46235e7df1bb5adb5b6e182ab0699c2cd107b563c91c4cf62073f79cf126665a2b4145e3a1ea3cd8b172ebf43893fa8b5dd1e146fd538e0a934835fcb848a559fc2f07e08a996f959fb4618e4fd23a7b667c7c4da28903b64b168a3303a39be7b121c46fee3987e5f5c6b931f40b7323ba76cd1b78729d2b5b0232a99002a5e1ff34e261739b471b5215e762b44cb233471c14b3e1fcfa34b4366d8741eb9ebf2b0d8201f10f2df4662afda391e0638cd6435d9df7ed39b24a39b5f293032a4c0f2dc3c774e3d077298c083b5a36d43e54d82c306b6cdbd409deb817bba381c574795c2f51b57890226c9c686dc8a25453e5c286642a834bf9f89e7e9eb0026cad63681af4a5e465e28321a281cde87d35e69d32e8ca3f0b05653cd6dfd2d1025cbb742d02af7693e0464bbd91dc18b1cf25c008c886b528e4320be7c9429abe12851029086885755db4ee8686c015ff523e81a65808e00c7ef24c1df79fb50a85344769f67f6e6196ab573814ed594de47e42a4d4355cd3962268733e9daddf050fb72cd60fae27ab1d22def303224b93404c628a6043388e2030d98a7c6799022199982097711c750910748cc6bb6e2e395f67ed4cb39cb6722adeb24e04df4f0255f1e1ee4ff102ee9b3ea7cdafd3462d520db9944ab7f8f8d30597877bf83152b88ef5cecb46a7097a58914cc8dab3979edfae6153729995b9618ef83bef27f7b88f30e32a8750ad68e3d50fdd43e3ea1aad6d1830c48f31da6a55a2af5377b7feb3852e4e2376b209f1fcbf7d99135749e3b5b6f2988245c53e2e5dedffc0d4031e7a57e209e5c2b87d6e82149255f034c3fa8e6b737cc1cd6c6eea1e35da82e7026ab7f4fedffd2d7c6025428360c7ae6491ab6a4d87eb2ede2149ad607790bc3c1da9885f3d3bc738c41dc13331f422356699d7d2509464824ef93258b98f100251e23b64120c4c969708cdb6efe696626dabcae433dd133aaca8f9d4e90e89790360eed395ecfbf7246ab1f13237375fa6f77d3116d16169c7b38f9da2da864d02e80fead9588191fb6cfcdb4e3d5427743475b5f80a6c068fce545e5893a1759f03602baeec703293091ba43efcfeca9acb6477329024fdd47f6ab877838d45e027abe6ad985612252e553587e5800310692db59e9de7a2e8dbab0d8c6b2f0e013bdbf3276e7ff2563268ace625a5eee8fc6621e28b4ff107f350cd0caaf8a1a5c5104d04a0d64066b7dbd8f4836cac83d864318e7578ba91ca5049f998724b56bb031de45658816ae33235a494f32762f66bba820d1f7bc6b0cfd35f8486a0f11149022cbbe17895cfee9761df0176c57829e2696948f56cae7a80703763e3fb1018b199c6f57001db111cd048cf48fd070eb00334657eccc3642bb2f82e55cb9c8434ce4c6466576c4cb4033e188c4ab309ec190c0c731d8f79b8f66345ac7ecccb7e15dc0a924d0da723560a9ec529d1b523310808567327f2a4b8970de0fe8bfa8f028612fe58d4a8a898bcd56dd81c14436e62eabea4889af26e1a2a5fa3e1e390db032d8bb78a1d816c4b9917fa64292d3d413d1f75b79d3c79fe93a083866bb21ce17f1bcbe67c5ffdad6e055d259b6bfdae6a7dbd96b1192b3e8c4a20515f886b8c2bf44cea2d063256f2a729dc59db73a274d4348270b29518fc5cef5b44746ebbc826450e56ffd2ddd7b3f0f143b120dd439fe0be5aa2ffd2af93e7fa1ce30ba10230ad7b95d68397544c1359f7c5f138c0006455712201d3a8558f6f165b5e43530277f03b4406b685ca05cdf469d2d5c9cab401db5f173b4b966aa3e902f5b9cc5f3f7b4a9b7dda78aa72aea595c4133df9dd5f38286bf752d35ef5218f68e274e035703d54f20f7159a30f0e790cb03ed2237f46e5aa895ee50ce0e58ac5f78d7298804218bedafb180fa5f9b53ed4ca7fe04cf63053562f1746c7a14121d87f020220bb366f7631cadfdb78b2fdb0ca3b2a133caa215637382a04b6df31a25e8e800336445b96274d3237b9535e4c9db171c189bd9bf678f917ca0019b070c36f9d49963cf02a900144fb73c513fb7d015373197e9c447454d41b298a9b199346332171e57f8f868d3f6759b9b5e39e0d5fa34e780b222142e86a72f150136ecc2503ac89e23481158eb38b964e20cbd367fe6dea1138b0b92f9b7c50d691b99b81130217b637c5ca1488953bd7257a4152680d309622e426d611b7dd68ef78e5cdfc8f0332708594c7435aafe6872795ee7ae56f1b495fc2c2d7b1b79c4f0e08c35fcfc51857032c396da4d5fc6c3cfc547aa2f15f907dad66f64f8287eab55976388438bc667de6b842dfbab6147a0ffa7b99b27d6edc57761100ff2dbd40d039f9d74294a8322cb3aa05bc939858788f990b7e440baa6faa746e40f8262ae9a99ae95903f077c560db115c4335de1f38a3a5d88ba0e45550621bb81a0ebbec1a994e413a028f6df748ce0c9aaeb69aeb5767c80421779ee624e6d2483aacb79ba473a1cffa5f801bbb4ff7a71028c8d3b79d4991a8cc44124f48ce71e2c27a3073769387bbafc24e60cd6d515a670e93abe112f1e359bbe19e5aba64feac8f115476b52b4a96e84a6d89604a83104fc910a053e41a9afa3f6525b8d85ed408b5104bb784d3029bb51298e0fe5fdb038905636f5cf31aa6087fffc2b2757450753c350700337102f38b62d889c1c15036e7d6812a010d194abf425da9ff7a4d2dc1d0e560d42c650713eb30fbd56cb01d689b334f4dd66ef4f233fd4dd0c43915851cf1d4f516dab6676bf8f50de9b3165ae14e2668e6f5796229ac83224e1a7838932bc7f727c77f43415ea3f94748741e9bd14b1d0969d0f23043f957c4662fba1c9b6e625083023fc2981aa636a2c1620880c45211ea12ba009c9a48ee5e26e746b3cd70b35f7b029b670a5e5a1e8b3170a25c4e23fd60383b354a115c6dbac888d1ff537219237c82b193d97215d902097d4a067812aa08865302f68e6746d61768a78c8443e9540e9d6294a871e71b45777992abce10afcf19d3fec7b86d32268d70109f4645b7a305fcfe4b9fbe80d34b79c77e70f894dbd423d8322aaf093e08255be0a9942e023363b3458785dedba86fe1936b8c30e216f2bb3d4a5e8fbc65264c43242b995f03348cf899d14175c57cf521da92723eeb5b131088507683171b7921bb6b48988406d6f19f79e4406da06f4b15313a9165098fa1bb729dc8020da7fd9359f507afc05ec876e5bb68fe5ec678a13f7bd7aab8452cfb60024643df7e48c8c5c1c57b9311cd4e75f5f1f671d8989f669c359611ba83fa20b86001cfe6323cf76369cf03e47bec7ad882fc92893b0b9be3d4224d3f122de4138376215c42cfd477b5715802e5fa3bd3c19734826590c868fc9d891201a67414a780d03cfd60883c1c701f20d1684b44962ad6c963ce1428cf491aa9ea3e175ad475bd94826a0a64e172255b4efc7760cc20d05bf4724fd2e60c950f825a75628d656ed962855238035da74733659f0dd2b591dc323c8efd224ee49bd292010ada96904b972a1dc1a444ba2d0377459704c1d850578a80c331e78fa659eda347f4866571c88db0d2d5b9907ec3035bb76225cc1c69db1ff50e5371b3a13eab46af6c1387631fe7903476d1ffa72d8f64b7c58f2f4381e0feba0b0f1fc5f23ea17aec68479d317cb4fdc0ea7bb4ff60f966cfc8aa8f6cb3264a800125a2a14904f2100c497e5a521c16540e822cd6a7c210a44eab973470b85485eadc624dc7e00e49d78e97e5e37298974ffe4fa0022a689d828cdad3a1093b1fbe4e0a1d69ab6cfff2ef3c2ccbb04cdbf782bf62f602e0414937a0fcbbd156c08215ca95d92135b481a981def8ee8499298e7a73beacbc7466add011eada951de0593831cdc24ec8d93cd9508f8e3dbfb4b929e6d4a2a24da0b5b65511f3c2e57fbc1115c0004f869db356785d4c23538bb99e8c67aeac4669423ecb4d39dbb35307a9b4917b71ab947d3c072954c95417f142be532502dd01ea821c3fe1092464611dd1f20cae82436cbe891d1a7985a26d96f47f17d10363c6de7f685b158db12d9826b2d8ba3ab5728690ee4651ddf5a175f74c84b8e5ec1c3a77a1107d2a0b53d7be6dad57332295f5c83970b7c82817b1a0d0c4321aeca2c813af7089241953f960ba81937563ec124cf8e0db78a97d76c939ceaf00fda4ed16d86674557b66aaa3223721d39eeadd4dc1c592697adb2db2e53e56ac0324fade9872d7b3568fde17395042d92379d5cb425384979d7fd29c46e49fe8610377db3dfc5e557e3a6c82639401f49ebda7b2ee497846335ebfdde02856ea9f463087860be30e2ed57b4ed5922a641f7a05742f1b7780218e95b92a9d3a35bb8059484cb46d7a33b1a3a2d83fe4d3b8bf8167056f339e31519661249bc92b3803ef86d80ec8df89d2d03928b003747b709ae1d697c0c826cc6fcf970cdc0439cd039833a3418f370315468a72237a67a407123a196d6c1f3e3fdb9f4d7ba575b5a502110fc01d45122a8dfb1352783951e1a20bf3b34c7d9fc6f38260bd87d333e82ce43247fb4367a04bc3b27c919ef1e0a7ff5eb5e037bc5def8adb3947361196a812b51ab0a93214c54c3ad72b3456ccc4ea5512b33e2ce06ec5c8e74bb7e0796e0175454e0aa2fe91cbfbfbaddadae6f47212f1b57f98bb49de776e6139221ce40296203afb834cf64385218fd1cf6264fa27ab26d4be9b41122d644e86ec7d96cc0228bd3484d051e49a2965377d0a8ecab592909b634d50dcf601b3c9b525b7fbae752b125c0096d12de7ef99e9255c6cd748155697760b683ebed92dc95bbfa2b739592486429870c9b2b4cd508ac53cb81b0a8aea52ff43661e3c5a8058f55cc406650ba168cb2c89298e3a2f1a65a809003e5c23eadd97cdaa816146d1c2a91b033021d7b559ea21e487e848748f3f9c51d2b301c26be0764fe54d4c68ad9f2335037dc8ae8f42a2407450a97930f1b4bc5fdd3da7b0cbc8d9dfea89b098c2e2928ea389f5d7475bc5b91442bf94f51bee066b78637a8833cba70c61d949314e5e9950d3523b27f32d69d1fc49a0301416ef29aeed35dcea8b3e5f9224edbe3189208464edd12ad7f99ad96ff974f6dd7ac382e9c8ce07131321610dab61b9dc317603f6f848de8c50672921218c357460bb435d6dc651267318929905badeb1a75bcc0255cfbd0b0c523eb4ee1579d8070b3dac65d09d6419feedbddc6a1ad1823446d74bd57591ca69b4e08374a04a0536200fdf9281fb047c221438b3f3e51c3798d268bf2dfb580b7170a03ade7ca6d7c10524be604a1adcb8fa8f47cc49e6fc3e4c3d5de3b30dc0e663d2372a1bc6226e70ed7a43b33206d6b9b72edae12c8b249b02f05f662e524a3e77c2c929477fcc7c3d544f346f8ef52eaca9f0ae6b5c22a06502f16a23ea72ba4b566e3fd0c984789a556a8ade902481d519e4931a6e9f0d1c7c71b6c4037b1ce95c05854c24987b5330ab8995f5f75c029833fc31b81b7cbd193848613cb477db4975c1e7234000a673c760c4adbe11c6ffd7d51c873ab25f1a939e6dc7feb4ba038b50bb705b68fc76977360015dae726fbe2be395fb70e5cd03261300cd7011b1099bcbeb7a106dcd56237da9b44e47cbde239a858058b743ed0251a4cebfdd3fce2240494f3b8b93efa53cb82afa8d25dabbef6e3ede2c5ccdbbef693129c7c27b5a0b07dd15d13b50d037cd508cafc3d63bb1f353e83ef2da4c109e99dc32a67ca8f17f1494ec333706e09e7d10c9b38f75b6c23e6052fd6538693d71a009ee2da751fe45b4d6f0448aebb02fd6d8d846f7928a5088caebb85402ba6e972e0e3265c943e1ad39c8c8112a5c69cb1da8fc04ff0ef5ff4549a4e50202fb18e76b27ed92cacb322d3c1bf378cc76cb98e96e0962c20b741ee5e0aadd5223b2b70cd3a74a16be45efb531849574d3ec24ef44a60ef577afa887618a3e10e543f561df4d7c6119e93bd87470d1a0f5f717d119babc66bce1fc501e561e749d42db8ec651f5688f403080c7ecd7ac57c3b5e43f840a246d7aa3dffc0f3118029b38d1add9858b4ae51e883cd60317b6c24add742b0941d877e45962193877a6034debd3d80289e920ae71afa5dc23caf58a0278a285eb4102238eab132e3eb2a10bc795c1935eadc2e921a9a1b510db1e9f2e48340b4a57fad31d4711a4babc4390f9b4a8009a162bb2bfb44c1f638557a2738656921ffaf55c4093a1171992a75aa1fc6fae0fd47e9f1a4dc7f864b446922687065deeeffb17362b42c498ed0c02213c1ab708631d2df88fbb716a55c947f99396a9ee739f0b7bf7d763ecc6b54e02d78b42f4ee26c11362f8bae92c32e8764f8e4e3ec9bf0ca86f0c9400f94182c14c59ffb62d669af2209c151b7798f0019207adf40f8dfae3745450cc242f084c8e71da488b67895e380245937f70c4a9937b741d3584c2ce8c321c1ea3986f87b2a9f4d63f467b49e4cd2c0c78eaeb969e729cbd48c54c2df1b9bac3617f4d7c024a6d0157b8dd3cd387d3b5e877ea1cd954177ee561a365f6316b88d14b6a3adc02e27be946bfce751677b4fb88f1cbe00962086aed8c917245adec0a577ee139e307008721d795988321a25d48a693f9ef28fa2f639492f9046569de42d1c595d8f653e4c7dacc50cf5fc7235c6d15c3b26636165821ea7df05c44c95f8cb455813f83712df24b4b71bf0425108cbef81fbda0dc3ca81a1e8a87b92a17590bf1be0383d60c8618ecae84b5e4dd92f82f88dc1c9865fa526dd7b7a7fa3ea4e36b78da02e4f1f288aad1473c12598c1437ce4445dd4baacf001c5cca7c955b4ad5c8de142861baf1d95c9d877358acc3d64408d2c394fceb6a389c82ed27446e935e925eb6275f3182d2f269c13f3e1f0ce38acb8d4f6d12db5896d1a06784ad5d7fb28f7c4dac7e69191a3bb7ef5a6ed1020aab4df2bfd2b959ef953e83e3d802cfbf7403c4004a349781c1ef3f42b3ef8c641650e919db57beca6e7a3fdbe3067b8eea2d031f43d8ce0b70b987fbc9f1740f8df959024eb4e68a34c1913145af5d942fd509ab2b69f833844e4d2c4dc5e77ba0ce972743366159632fa509bcfebc9a4b20259995625091be81bc35c2d2e3cf876eb51ac1843723705917c082bc8237d195b45309c4aeb53daa446f3127778d6eba0f4c88e4a80b74d83a8397927d7b4a6b7c02eb58b1315f5e5ed65bd3f1e6fc0f799a6739b0257c904a4271ef771381d2c833028a8b355d805f48e5da46fd2045cd93294bec9ebab0fbd3193fac96e59bc5c76b8adb55a411f7e2913c42261e1245cd0d28532728a47849ae68359589e9cbda19545a5c49c74ca469c2afb1fc65970f2f46b1345f7a0075bad221000fcbec3895c1b63988c08b4d08e8d0fd3ca29391939490fb8b322064b3b7f320de2105a4670303c4ba52de92ed18424680c77a0d63e61aa19d4d4bfc72dce78b39d91684d8e20378af1912d5631dbd10d9f6a814097e73425e5e579ae0969c17eb9f926b2ae1b54a1b119e3f1d04706fe1cd987e1898c1ce66a152a0d6e17bf8f7fa959b4c7238a3d4ab0b724f3357ca32ae21c98cfbdc086ef412b394ea56c9223cd282793c2de38b94b9d9eccd3a219b0e7f84d9b6ef420c913311ee4d850c61d4e710f958e40250f978ce561455a4a39583d4833142045ac641093adb3580e142078113160f2c02fce7f5d53f31fb8508927e8d2a56c4e2d00ebb41c2d2f8d7d35d77000655a32c40b6fbfcf839b5c9ee42c963d27f7ad7d07278cd770a40bdd15ba21ea9bd29b0fe1d3e1d35e717036e6d533b38ac8ae672437a95ee418604bb6b3b5f5f1db5093daac35e25db12d5a9768418d357cda4b2ca8a748ddbf9555d3d3deec50f7308031c388b33d8a8e6f28d99c1049b8fb81b7b945886a1d987c513bb1c7de45ea2e3035e9f65a4c9aad8a5e97db9ae90fa1416f969b5983857132f4a9c1a1a2ea2951ee93e74e9cb8164b6c4b713dabab6c694fb83ab20b5a70995848d8421170655b68d1949697472e754b31b7c899c85e90f0f5c2c89af3781add4dab2560f546907e8535a1fb83c2fbc0f42b2cd8072dca600cb05b49c101630eb5578a05a38ed4a03de68ca5d513229851039be9db404c680cea53a10ca49d18ff5152bd37325fa6f03798b8e654f442e23beb2c4d17fd2afa8057aec2d9d067579405f08c922a34ca64f96cf27bf61cda5a4ec16d8c9b45321e7b4f0a5e09e313d60085d40b3bd1233649b8df593a3f6ec427e900d3dd791ce9e41b78094ca822e07ffc985c8dad70b2dab3449b9ec7d5d13ecfd2facc38fa3f830a4181b07f09ee8ddf7fd51ee2787038afaa823c82b20f7e4f11b054f8fa5afd10b4a79d94554012374ceb732dee30f030ec2326397bdeae0cfa584ee85845202c573c55e74a8e25b9a0a30ed692fb29044077f1ef338e481b9860b499916914f23db9758e2bf3d988d6b5286fca8e2e405de3b91883a9a4f9df12c5c6783e80ef40cac35a827be29a359cc5435e70d8081f7aa83a9a0334d9f4ef34b009d966f0ebea0fba964cd30d2aa851c35076c1003128174bc52544167dcc548912785d998509251444e52c60bd4db285dce4ba370033115b819aee8d6485c691d849f2d1288b9b8499c0768b1d0b8239233a75abab1d0ba7f9f4f0a9c8b1b8f63102f889e3613f69ea81f0022f428f3e9e61d5c4a28c38ad475cfd2800def6d8ec9b6b93598f34542490af40031fc789727e0a85f4d839a0d4f5ccee22349c9c774f40f7c7ab502892cd8324266145bc566b87f104d0281efe41effd3e8667ac9a210ac814a2029edec1f61fef234913ea14690259006036be618474034a80ed8d858e7e73c8c5086b36cd8c25bf524d9b50c833af69380b12f67cdd7818051710251d81dab9d675a2ab960e3a73d5128b5f151b0265624d72d8322c8bfc35bd5b9e1f81d6fb07a0d0f2ddbc9bad751ef836652b82fd1625417bc7c117dd2bf7f2f596b5c27ee564e879a99c7dffec5ffe07982cf76fd850305d964a968ecba7fb9b29b5356e796986e529c992d7b9393642d0e022e788b6303e0956932c0089a3d746db163202219b888aeabfa5ba388782f4ea6e80edb972eb75382e129a34eaf2578b8a47ae8d229ccb294b1cb0b82cc565fbaa45b3b4054f6e976fb2fa8e771b703b4d47bef20793ab5e88514491a905da856863f29bdfc0d7c079b4f65e974dd51807fc160b6c437e6b5cca1b36749cb4aaf8aaf7e882603410997e4d2b877fa80e5ebf0f6038fe9fbef8a45b3818c97fbf7fe62337c7ad8030248451b0dd64e68361c6c56debd4c7d5ef3a2e9079992f2b48630ed957925b90098f2856bd94ec0bd33f8092923e994ffea91ab2ffa878e1fef7e5bcd557832fa192cff59553871055ade4a25ea43157582de99fdd17d6667155b6913a54a960daa009bf855d251af968dc59e0aeb124194737fba76bd0af0c985c6cfd4ca22039049dd08c408454a674b2bfdbd2133135b9eaf6f7a68a3ee2065ad064c01cf9802297933331d0d6318d4938b9fc9af0815aec5339207bacbd9411aec0c856fe16f6fe2ae67b2aa3603080b328232c174f67490bfef9ff3f625a997b8c77bbb1c04ebbb9587bf1cb8744d4256f17b5932f72db5b88c297f9614f2c6d7d95bb6b1c8036c0481baf3cce13880b7137a1b1fd04d18e7554c727e9abaa825c494b53c8f02e10f06a5e664f0932ebeddbd84cfc8d1b88ddda887763c4d342608233b22078403ec097a1e42d39a94413eedd8f17e3e3424aac8f0021fc86224aad5b2306100a1ca6bf829658e8d8c724efe8d3410e32ad93780378311e3db168ff132a5666df348d371b4215400802df3f7399d72cb06842cd6d7e30575ccc706eddda2edf9c8ef02227fdb748833e25e6c4222c508ac431bf848879703f1888c0232505d06540303913eb47112b758c39b08baeff3ff015e671c1dd55721d7bdde6b1a2f574296035eafffbad42d6c2ed8ea6060db0fd416a8231a7fbd1e8b7006a9f084342c6135c35b4155e9c34c4192a93adf4ec9419f8670af8ecfa25bd4d3ed1c16e207c2938bca3b68206a3a95fddad3612faa0b95b7090b2f91b4b47d9757732a7e6d53130a06f46ffe6db561920d1379f7944bbd85bbf8e4c4cb6052f2e2313f9b7eb7030218a3c3bc0400f16b2476cc3ed925542e7f5e655b0d6a6df52494aff022f299b6035039e34280bf52e8d2e536f82ffecd30feb195568b5dc788ee1706d767cc8b804ed4433de2fb3a7e911bada42c79597dceb36dff3e66b77cd5707283baac258ea1419633d88311b93db1364d7cfbd09c3c52acc8a8bf95a673b3372ed76fb9ecc757f3a2537d0b919f7949fa0377834158d11a0767740f6345e41f560bff0275030906f69d80123ff69fc3e4f77bf5a4ccf496490e04cc49465ae268ff49a930ee03ee642c863496e84c412249dae2c10398bff43c841d79a39ad967cce3f68f6d299a4a8288239ae3dcb46965215b834b5cc0027bbe5e3284d4edf927f998beeff902096928a1d54e7ff200cfe24484375da3c5066c95e4b298cd151959d6efa40c4d6c03ff09eab8bc0d1f4b3d2ad07d7ac99fed49ed94f72b57fa601286332c0e03bd0abe50f532a3501d3eba4fa70345f3e4b5fd1134e50e1fc2f60819dbbe88f60206f7c82851b1a4ecaa9688b72e804aa5ea31c8df5307abe99249395c264c77233570d08a6cc6db5f6997c8080ca00153a3e959e9c54a3ea532d865b5fde8092252c99194086a41b3534ff902dcd27e7495dd3097d301ff04062ab69ddc3550019a8fa8762474ebf9660fdde076bc8ef471508b2af557f55203d89ba97c49f8b7020fba4040f0421321c604413c64f2e185e8cb39f2a60f69e4c5ab945e8dd0a43f02b2c6c13a3d496863619a788944125c08b5fc66789b86e04a513f0b30a5dbbe04d02546eabfd52e4dd33097d88cb3d448c0a1520fe6329d4fd8b72172ec359977bcc8aa74592142b51a14f7914c6e0cb0daba159ffcdf9a0331f3cd4c8c5c81fb1cade78b7519dcc90b834f35477f99d152f158c98c0bfe296e76599171c5bc120341b001a3473bebe161130a8696cbaff7f3dba5a4d09e40b5af9fb59ee2cd5fc303755beb967f07789286691fe39e20a095ed07acd3397df6683041ada678193cd2031bad1b3fc9942fa87f4ee45532f90352418b2bd50a188e09f9d589ae5b3364c6181a85d6a316c7260b6d91f604ed93f13c87c3dccfccf53ad665d409bf0916d59d216246e2f13d4448367c7f5ebd5ac799b12095d1533a1703bb79990932b502aa86c52cd3641d22322c19851b17f14e49d47adbab1eba3177f904aebdd5ab5702c7292623190bb867b79594a789089502688198ecaa4a3c76d835918ef714cc06d1cda89fddcc01679bd425b874eeec5ad51893e26770c95b708969ffec0a55433e1e97f6dbcd947ea53366eece75a05be99d58b0e90985672df25eb1490925d2116a9bc393f8f276ebb1a54c44ac36d96d419169731dd5915cd863e9af03e36e028bd5606887ca6dadbd65efc8c5ed2762a45bf0bd16a25b4e9e1e979cbf708ef503a200285367d07fba2bf2b4a7cc36b7c17dfbf707822a4be841c7d79f2194873c30f2948c34f775add8690055995c80e1cd13f2ea7139235be6c670d8e716df73891057bf502ba1f5feb48528768457d31c5acfdc62918d1eeb83f24e637c243aaa10ed78d2241cb3d09dd2266583c63244f843b457d0fbdcbfab86e4ace5278178081873a74a253e035c341550d883939c4f5f758d3a9b75447dd5db37da29697fb49d16b858e7928f565ac6e14ac9ab27f05ed1fa24c86efb1cbf9d02d92a5afda71870000100020047304402204d36af2023ded8de1caba9e34aeb246e433b257249f096079499eb006591dfe40220405ccc78e2f990b30a10574bfccb81fc6505cfd1cc87c7ad789383f4be159f7a0100210367ca10effa232ed2df42545895790a4b99269374f3ae8df23fa645bccd2eecc5"
    val lnMsg = LnMessage.fromHex(hex)
    assert(lnMsg.tlv.isInstanceOf[DLCSignTLV])
  }
}

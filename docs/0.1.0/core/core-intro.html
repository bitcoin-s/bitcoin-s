<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Core module · bitcoin-s</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="The `core` module is the core (duh!) functionality of Bitcoin-S. The goal is to provide basic"/><meta name="docsearch:version" content="0.1.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Core module · bitcoin-s"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bitcoin-s.org/"/><meta property="og:description" content="The `core` module is the core (duh!) functionality of Bitcoin-S. The goal is to provide basic"/><meta property="og:image" content="https://bitcoin-s.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://bitcoin-s.org/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-61958686-2', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="https://fonts.googleapis.com/css?family=Montserrat:500"></script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-61958686-2"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.ico" alt="bitcoin-s"/><h2 class="headerTitleWithLogo">bitcoin-s</h2></a><a href="/versions"><h3>0.1.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive siteNavItemActive"><a href="/docs/0.1.0/core/core-intro" target="_self">Docs</a></li><li class=""><a href="/download" target="_self">Download</a></li><li class=""><a href="/api/org/bitcoins" target="_self">API</a></li><li class=""><a href="/help" target="_self">Help</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Core module</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.1.0/getting-started">Add Bitcoin-S to your project</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Core module</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/0.1.0/core/core-intro">Core module</a></li><li class="navListItem"><a class="navItem" href="/docs/0.1.0/core/txbuilder">TxBuilder example</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">RPC clients</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.1.0/rpc/rpc-clients-intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/0.1.0/rpc/rpc-eclair">Eclair</a></li><li class="navListItem"><a class="navItem" href="/docs/0.1.0/rpc/rpc-bitcoind">bitcoind/Bitcoin Core</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Contributing</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.1.0/contributing">Contributing</a></li><li class="navListItem"><a class="navItem" href="/docs/0.1.0/contributing-website">Contributing to the website</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Security</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.1.0/security">Security</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/bitcoin-s/bitcoin-s/blob/master/docs/core/core-intro.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Core module</h1></header><article><div><span><p>The <code>core</code> module is the core (duh!) functionality of Bitcoin-S. The goal is to provide basic
data structures that are found in the Bitcoin and Lightning protocols while
minimizing external depedencies for security purposes. We aim to have an extremely
high level of test coverage in this module to flesh out bugs. We use property based
testing heavily in this library to ensure high quality of code.</p>
<h2><a class="anchor" aria-hidden="true" id="the-basics"></a><a href="#the-basics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The basics</h2>
<p>Every bitcoin protocol data structure (and some other data structures) extends <a href="/api/org/bitcoins/core/protocol/NetworkElement"><code>NetworkElement</code></a>. <code>NetworkElement</code> provides methods to convert the data structure to hex or byte representation. When paired with <a href="/api/org/bitcoins/core/util/Factory"><code>Factory</code></a> we can easily serialize and deserialize data structures.</p>
<p>Most data structures have companion objects that extends <code>Factory</code> to be able to easily create protocol data structures. An example of this is the <a href="/api/org/bitcoins/core/protocol/script/ScriptPubKey"><code>ScriptPubKey</code></a> companion object. You can use this companion object to create a <code>ScriptPubKey</code> from a hex string or a byte array.</p>
<h2><a class="anchor" aria-hidden="true" id="main-modules-in-core"></a><a href="#main-modules-in-core" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Main modules in <code>core</code></h2>
<ol>
<li><a href="/api/org/bitcoins/core/protocol"><code>protocol</code></a> - basic protocol data structures. Useful for serializing/deserializing things</li>
<li><a href="/api/org/bitcoins/core/crypto"><code>crypto</code></a> - cryptograhic functionality used in Bitcoin and Lightning</li>
<li><a href="/api/org/bitcoins/core/script"><code>script</code></a> - an implementation of <a href="https://en.bitcoin.it/wiki/Script">Script</a> - the programming language in Bitcoin</li>
<li><a href="/api/org/bitcoins/core/wallet"><code>wallet</code></a> - implements signing logic for Bitcoin transactions. This module is not named well as there is <strong>NO</strong> functionality to persist wallet state to disk as it stands. This will most likely be renamed in the future.</li>
<li><a href="/api/org/bitcoins/core/config"><code>config</code></a> - Contains information about a chain's genesis block and DNS seeds</li>
<li><a href="/api/org/bitcoins/core/number"><code>number</code></a> - Implements number types that are native in C, i.e. <code>UInt8</code>, <code>UInt32</code>, <code>UInt64</code>, etc.</li>
<li><a href="/api/org/bitcoins/core/currency"><code>currency</code></a> - Implements currency units in the Bitcoin protocol</li>
<li><a href="/api/org/bitcoins/core/bloom"><code>bloom</code></a> - Implements <a href="https://en.wikipedia.org/wiki/Bloom_filter">Bloom filters</a> and <a href="https://bitcoin.org/en/glossary/merkle-block">merkle blocks</a> needed for <a href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki">BIP37</a></li>
<li><a href="/api/org/bitcoins/core/hd"><code>hd</code></a> - Contains implementations of hierarchical deterministic (HD) paths, that when combined with <code>ExtPrivKey</code> and <code>ExtPubKey</code> in <code>crypto</code> can implement BIP32, BIP44, BIP49 and BIP84.</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="examples"></a><a href="#examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<h3><a class="anchor" aria-hidden="true" id="serializing-and-deserializing-a-transaction"></a><a href="#serializing-and-deserializing-a-transaction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Serializing and deserializing a <code>Transaction</code></h3>
<p>Here is an example scala console session with bitcoins-core</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> org.bitcoins.core.protocol.transaction._

<span class="hljs-keyword">val</span> hexTx = <span class="hljs-string">"0100000001ccf318f0cbac588a680bbad075aebdda1f211c94ba28125b0f627f9248310db3000000006b4830450221008337ce3ce0c6ac0ab72509f8$9c1d52701817a2362d6357457b63e3bdedc0c0602202908963b9cf1a095ab3b34b95ce2bc0d67fb0f19be1cc5f7b3de0b3a325629bf01210241d746ca08da0a668735c3e01c1$a02045f2f399c5937079b6434b5a31dfe353ffffffff0210335d05000000001976a914b1d7591b69e9def0feb13254bace942923c7922d88ac48030000000000001976a9145e$90c865c2f6f7a9710a474154ab1423abb5b9288ac00000000"</span>
<span class="hljs-comment">// hexTx: String = "0100000001ccf318f0cbac588a680bbad075aebdda1f211c94ba28125b0f627f9248310db3000000006b4830450221008337ce3ce0c6ac0ab72509f8$9c1d52701817a2362d6357457b63e3bdedc0c0602202908963b9cf1a095ab3b34b95ce2bc0d67fb0f19be1cc5f7b3de0b3a325629bf01210241d746ca08da0a668735c3e01c1$a02045f2f399c5937079b6434b5a31dfe353ffffffff0210335d05000000001976a914b1d7591b69e9def0feb13254bace942923c7922d88ac48030000000000001976a9145e$90c865c2f6f7a9710a474154ab1423abb5b9288ac00000000"</span>
</code></pre>
<p>This gives us an example of a hex encoded Bitcoin transaction that is deserialized to a native Scala object called a <a href="/api/org/bitcoins/core/protocol/transaction/Transaction"><code>Transaction</code></a>. You could also serialize the transaction to bytes using <code>tx.bytes</code> instead of <code>tx.hex</code>. These methods are available on every data structure that extends NetworkElement, like <a href="/api/org/bitcoins/core/crypto/ECPrivateKey"><code>ECPrivateKey</code></a>, <a href="/api/org/bitcoins/core/protocol/script/ScriptPubKey"><code>ScriptPubKey</code></a>, <a href="/api/org/bitcoins/core/protocol/script/ScriptWitness"><code>ScriptWitness</code></a>, and <a href="/api/org/bitcoins/core/protocol/blockchain/Block"><code>Block</code></a>.</p>
<h4><a class="anchor" aria-hidden="true" id="generating-a-bip39-mnemonic-phrase-and-an-xpriv"></a><a href="#generating-a-bip39-mnemonic-phrase-and-an-xpriv" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Generating a BIP39 mnemonic phrase and an <code>xpriv</code></h4>
<p>BIP39 mnemonic phrases are the most common way of creating backups of wallets.
They are between 12 and 24 words the user writes down, and can later be used to restore
their bitcoins. From the mnemonic phrase we generate a wallet seed, and that seed
can be used to generate what's called an extended private key
(<a href="/api/org/bitcoins/core/crypto/ExtPrivateKey"><code>ExtPrivateKey</code></a> in Bitcoin-S).</p>
<p>Here's an example:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> org.bitcoins.core.crypto._
<span class="hljs-keyword">import</span> org.bitcoins.core.hd._

<span class="hljs-comment">// the length of the entropy bit vector determine</span>
<span class="hljs-comment">// how long our phrase ends up being</span>
<span class="hljs-comment">// 256 bits of entropy results in 24 words</span>
<span class="hljs-keyword">val</span> entropy: <span class="hljs-type">BitVector</span> = <span class="hljs-type">MnemonicCode</span>.getEntropy256Bits
<span class="hljs-comment">// entropy: BitVector = BitVector(256 bits, 0x574d20e6ea2087645573fba9f81e8ce37978145d099093e973e19dc5bbec4a28)</span>

<span class="hljs-keyword">val</span> mnemonicCode = <span class="hljs-type">MnemonicCode</span>.fromEntropy(entropy)
<span class="hljs-comment">// mnemonicCode: MnemonicCode = MnemonicCodeImpl(Vector(firm, harbor, defy, stairs, anchor, rate, fiction, legal, prepare, science, permit, shoulder, nurse, any, injury, craft, negative, entire, wear, describe, forum, wage, chunk, buyer))</span>

mnemonicCode.words <span class="hljs-comment">// the phrase the user should write down</span>
<span class="hljs-comment">// res0: Vector[String] = Vector(firm, harbor, defy, stairs, anchor, rate, fiction, legal, prepare, science, permit, shoulder, nurse, any, injury, craft, negative, entire, wear, describe, forum, wage, chunk, buyer) // the phrase the user should write down</span>

<span class="hljs-comment">// the password argument is an optional, extra security</span>
<span class="hljs-comment">// measure. all MnemonicCode instances will give you a</span>
<span class="hljs-comment">// valid BIP39 seed, but different passwords will give</span>
<span class="hljs-comment">// you different seeds. So you could have as many wallets</span>
<span class="hljs-comment">// from the same seed as you'd like, by simply giving them</span>
<span class="hljs-comment">// different passwords.</span>
<span class="hljs-keyword">val</span> bip39Seed = <span class="hljs-type">BIP39Seed</span>.fromMnemonic(mnemonicCode,
                                       password = <span class="hljs-string">"secret password"</span>)
<span class="hljs-comment">// bip39Seed: BIP39Seed = BIP39SeedImpl(ByteVector(64 bytes, 0x736cda24cdaa9d037276191a07f0bd067c0bf75366241f35830f7d99741428ec2d03fd7ff896e7f30f4776bba8bfa5fb4fc9692443f20d23c840d0a59a774541))</span>

<span class="hljs-keyword">val</span> xpriv = <span class="hljs-type">ExtPrivateKey</span>.fromBIP39Seed(<span class="hljs-type">ExtKeyVersion</span>.<span class="hljs-type">SegWitMainNetPriv</span>,
                                        bip39Seed)
<span class="hljs-comment">// xpriv: ExtPrivateKey = zprvAWgYBBk7JR8GjK4toR1D3nBk7hzpR4Ub6teUFG29phdrKk9f1ERymniBTYR4586pZiTwC6FyCgrnG9SEeRNRqBehteqSsydiezHJfJTDPZL</span>
<span class="hljs-keyword">val</span> xpub = xpriv.extPublicKey
<span class="hljs-comment">// xpub: ExtPublicKey = zpub6jftahH18ngZwo9MuSYDQv8UfjqJpXCSU7a53eRmP3AqCYUoYmkEKb2fJpPXe2QLTDunZhBE8j8Bg5twZ3SVvpSb2suuSbmp3zEW5XTV6vM</span>

<span class="hljs-comment">// you can now use the generated xpriv to derive further</span>
<span class="hljs-comment">// private or public keys</span>

<span class="hljs-comment">// this can be done with BIP89 paths (called SegWitHDPath in bitcoin-s)</span>
<span class="hljs-keyword">val</span> segwitPath = <span class="hljs-type">SegWitHDPath</span>.fromString(<span class="hljs-string">"m/84'/0'/0'/0/0"</span>)
<span class="hljs-comment">// segwitPath: SegWitHDPath = m/84'/0'/0'/0/0</span>

<span class="hljs-comment">// alternatively:</span>
<span class="hljs-keyword">val</span> otherSegwitPath =
<span class="hljs-type">SegWitHDPath</span>(<span class="hljs-type">HDCoinType</span>.<span class="hljs-type">Bitcoin</span>,
             accountIndex = <span class="hljs-number">0</span>,
             <span class="hljs-type">HDChainType</span>.<span class="hljs-type">External</span>,
             addressIndex = <span class="hljs-number">0</span>)
<span class="hljs-comment">// otherSegwitPath: SegWitHDPath = m/84'/0'/0'/0/0</span>

segwitPath == otherSegwitPath
<span class="hljs-comment">// res1: Boolean = true</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="building-a-signed-transaction"></a><a href="#building-a-signed-transaction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building a signed transaction</h3>
<p>Bitcoin Core supports building unsigned transactions and then signing them with a set of private keys. The first important thing to look at is <a href="/api/org/bitcoins/core/wallet/utxo/UTXOSpendingInfo"><code>UTXOSpendingInfo</code></a>. This contains all of the information needed to create a validly signed <a href="/api/org/bitcoins/core/protocol/script/ScriptSignature"><code>ScriptSignature</code></a> that spends this output.</p>
<p>Our <a href="/api/org/bitcoins/core/wallet/builder/TxBuilder"><code>TxBuilder</code></a> class requires you to provide the following:</p>
<ol>
<li><code>destinations</code> - the places we are sending bitcoin to. These are <a href="/api/org/bitcoins/core/protocol/transaction/TransactionOutput">TransactionOutputs</a> you are sending coins too</li>
<li><code>utxos</code> - these are the <a href="/api/org/bitcoins/core/wallet/utxo/UTXOSpendingInfo">UTXOs</a> used to fund your transaction. These must exist in your wallet, and you must know how to spend them (i.e. have the private key)</li>
<li><code>feeRate</code> - the fee rate you want to pay for this transaction</li>
<li><code>changeSPK</code> - where the change (i.e. <code>creditingAmount - destinationAmount - fee</code>) from the transaction will be sent</li>
<li><code>network</code> - the network(/api/org/bitcoins/core/config/NetworkParameters) we are transacting on</li>
</ol>
<p>After providing this information, you can generate a validly signed bitcoin transaction by calling the <code>sign</code> method.</p>
<p>To see a complete example of this, see <a href="/docs/0.1.0/core/txbuilder">our <code>TxBuilder</code> example</a></p>
<h3><a class="anchor" aria-hidden="true" id="the-sign-apiapiorgbitcoinscorecryptosign"></a><a href="#the-sign-apiapiorgbitcoinscorecryptosign" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The <a href="/api/org/bitcoins/core/crypto/Sign"><code>Sign</code> API</a></h3>
<p>This is the API we define to sign things with. It takes in an arbitrary byte vector and returns a <code>Future[ECDigitalSignature]</code>. The reason we incorporate <code>Future</code>s here is for extensibility of this API. We would like to provide implementations of this API for hardware devices, which need to be asynchrnous since they may require user input.</p>
<p>From <a href="/api/org/bitcoins/core/crypto/Sign"><code>core/src/main/scala/org/bitcoins/core/crypto/Sign.scala</code></a>:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> scala.concurrent._
<span class="hljs-keyword">import</span> scala.concurrent.duration._

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Sign</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">signFunction</span></span>: <span class="hljs-type">ByteVector</span> =&gt; <span class="hljs-type">Future</span>[<span class="hljs-type">ECDigitalSignature</span>]

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">signFuture</span></span>(bytes: <span class="hljs-type">ByteVector</span>): <span class="hljs-type">Future</span>[<span class="hljs-type">ECDigitalSignature</span>] =
    signFunction(bytes)

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sign</span></span>(bytes: <span class="hljs-type">ByteVector</span>): <span class="hljs-type">ECDigitalSignature</span> = {
    <span class="hljs-type">Await</span>.result(signFuture(bytes), <span class="hljs-number">30.</span>seconds)
  }

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">publicKey</span></span>: <span class="hljs-type">ECPublicKey</span>
}
</code></pre>
<p>The <code>ByteVector</code> that is input to the <code>signFunction</code> should be the hash that is output from <a href="/api/org/bitcoins/core/crypto/TransactionSignatureSerializer"><code>TransactionSignatureSerializer</code></a>'s <code>hashForSignature</code> method. Our in-memory <a href="/api/org/bitcoins/core/crypto/ECKey"><code>ECKey</code></a> types implement the <code>Sign</code> API.</p>
<p>If you wanted to implement a new <code>Sign</code> api for a hardware wallet, you can easily pass it into the <code>TxBuilder</code>/<code>Signer</code> classes to allow for you to use those devices to sign with Bitcoin-S.</p>
<p>This API is currently used to sign ordinary transactions with our <a href="/api/org/bitcoins/core/wallet/signer/Signer"><code>Signer</code></a>s. The <code>Signer</code> subtypes (i.e. <code>P2PKHSigner</code>) implement the specific functionality needed to produce a valid digital signature for their corresponding script type.</p>
<h3><a class="anchor" aria-hidden="true" id="verifying-a-transactions-script-is-valid-does-not-check-if-utxo-is-valid"></a><a href="#verifying-a-transactions-script-is-valid-does-not-check-if-utxo-is-valid" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Verifying a transaction's script is valid (does not check if UTXO is valid)</h3>
<p>Transactions are run through the interpreter to check their validity. These are packaged up into an object called <code>ScriptProgram</code>, which contains the following:</p>
<ul>
<li>The transaction that is being checked</li>
<li>The specific input index that it is checking</li>
<li>The <code>scriptPubKey</code> for the crediting transaction</li>
<li>The flags used to verify the script</li>
</ul>
<p>Here is an example of a transaction spending a <code>scriptPubKey</code> which is correctly evaluated with our interpreter implementation:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> org.bitcoins.core.protocol.script._
<span class="hljs-keyword">import</span> org.bitcoins.core.protocol.transaction._
<span class="hljs-keyword">import</span> org.bitcoins.core.script._
<span class="hljs-keyword">import</span> org.bitcoins.core.policy._
<span class="hljs-keyword">import</span> org.bitcoins.core.number._
<span class="hljs-keyword">import</span> org.bitcoins.core.crypto._
<span class="hljs-keyword">import</span> org.bitcoins.core.currency._

<span class="hljs-keyword">val</span> spendingTx = <span class="hljs-type">Transaction</span>.fromHex(<span class="hljs-string">"0100000001ccf318f0cbac588a680bbad075aebdda1f211c94ba28125b0f627f9248310db3000000006b4830450221008337ce3ce0c6ac0ab72509f889c1d52701817a2362d6357457b63e3bdedc0c0602202908963b9cf1a095ab3b34b95ce2bc0d67fb0f19be1cc5f7b3de0b3a325629bf01210241d746ca08da0a668735c3e01c1fa02045f2f399c5937079b6434b5a31dfe353ffffffff0210335d05000000001976a914b1d7591b69e9def0feb13254bace942923c7922d88ac48030000000000001976a9145e690c865c2f6f7a9710a474154ab1423abb5b9288ac00000000"</span>)

<span class="hljs-keyword">val</span> scriptPubKey = <span class="hljs-type">ScriptPubKey</span>.fromAsmHex(<span class="hljs-string">"76a91431a420903c05a0a7de2de40c9f02ebedbacdc17288ac"</span>)

<span class="hljs-keyword">val</span> output = <span class="hljs-type">TransactionOutput</span>(<span class="hljs-type">CurrencyUnits</span>.zero, scriptPubKey)

<span class="hljs-keyword">val</span> inputIndex = <span class="hljs-type">UInt32</span>.zero

<span class="hljs-keyword">val</span> btxsc = <span class="hljs-type">BaseTxSigComponent</span>(spendingTx,inputIndex,output,<span class="hljs-type">Policy</span>.standardScriptVerifyFlags)

<span class="hljs-keyword">val</span> preExecution = <span class="hljs-type">PreExecutionScriptProgram</span>(btxsc)
</code></pre>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> result = <span class="hljs-type">ScriptInterpreter</span>.run(preExecution)
<span class="hljs-comment">// result: org.bitcoins.core.script.result.ScriptResult = ScriptOk</span>
</code></pre>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 3/31/2021 by benthecarman</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/0.1.0/getting-started"><span class="arrow-prev">← </span><span>Intro and Getting Started</span></a><a class="docs-next button" href="/docs/0.1.0/core/txbuilder"><span class="function-name-prevnext">TxBuilder Example</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#the-basics">The basics</a></li><li><a href="#main-modules-in-core">Main modules in <code>core</code></a></li><li><a href="#examples">Examples</a><ul class="toc-headings"><li><a href="#serializing-and-deserializing-a-transaction">Serializing and deserializing a <code>Transaction</code></a></li><li><a href="#building-a-signed-transaction">Building a signed transaction</a></li><li><a href="#the-sign-apiapiorgbitcoinscorecryptosign">The <a href="/api/org/bitcoins/core/crypto/Sign"><code>Sign</code> API</a></a></li><li><a href="#verifying-a-transactions-script-is-valid-does-not-check-if-utxo-is-valid">Verifying a transaction's script is valid (does not check if UTXO is valid)</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon.ico" alt="bitcoin-s" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/getting-started">Getting Started</a><a href="/docs/en/core/core-intro">Guides</a><a href="/api/org/bitcoins">API Reference</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a><a href="https://join.slack.com/t/suredbits/shared_invite/zt-eavycu0x-WQL7XOakzQo8tAy7jHHZUw" target="_blank" rel="noreferrer noopener">Slack</a><a href="https://gitter.im/bitcoin-s-core/">Gitter chat</a></div><div><h5>More</h5><a href="https://github.com/bitcoin-s/bitcoin-s">GitHub</a><a class="github-button" href="https://github.com/bitcoin-s/bitcoin-s" data-icon="octicon-star" data-count-href="/bitcoin-s/bitcoin-s-core/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2025 Suredbits &amp; the bitcoin-s developers</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '0a510688bf8448e19aeb380377d328d3',
                indexName: 'bitcoin-s',
                inputSelector: '#search_input_react'
              });
            </script></body></html>